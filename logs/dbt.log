[0m16:02:19.263142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA474FD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA474FD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA474F0B0>]}


============================== 16:02:19.270928 | 3459f70f-2781-462f-9e56-577265a96eee ==============================
[0m16:02:19.270928 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:02:19.272927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:19.474337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3459f70f-2781-462f-9e56-577265a96eee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA457A720>]}
[0m16:02:19.527829 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:02:19.528830 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:02:19.530844 [debug] [MainThread]: Command `dbt deps` succeeded at 16:02:19.530844 after 0.54 seconds
[0m16:02:19.530844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA3FB2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA4914B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA477BFB0>]}
[0m16:02:19.530844 [debug] [MainThread]: Flushing usage events
[0m16:02:20.843723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:10.235062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE796198E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE79423A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE7961BB00>]}


============================== 16:04:10.241065 | 2d7fcd54-cbfc-4751-bc15-da1d677d2acc ==============================
[0m16:04:10.241065 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:04:10.242065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:10.370811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d7fcd54-cbfc-4751-bc15-da1d677d2acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE76213FB0>]}
[0m16:04:10.406262 [debug] [MainThread]: Set downloads directory='C:\Users\6133179\AppData\Local\Temp\dbt-downloads-38huqotx'
[0m16:04:10.407251 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:04:11.077412 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:04:11.077412 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:04:11.272987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:04:11.296555 [info ] [MainThread]: Updating lock file in file path: C:\Training\DBTpractice\data_pipeline/package-lock.yml
[0m16:04:11.304217 [debug] [MainThread]: Set downloads directory='C:\Users\6133179\AppData\Local\Temp\dbt-downloads-ij3mnbx3'
[0m16:04:11.307213 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:04:12.186383 [info ] [MainThread]: Installed from version 1.3.0
[0m16:04:12.187380 [info ] [MainThread]: Up to date!
[0m16:04:12.188379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2d7fcd54-cbfc-4751-bc15-da1d677d2acc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE79CA5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE79CA6870>]}
[0m16:04:12.189393 [debug] [MainThread]: Command `dbt deps` succeeded at 16:04:12.189393 after 2.23 seconds
[0m16:04:12.190394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE76C71C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE76C72F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE78ED7770>]}
[0m16:04:12.190394 [debug] [MainThread]: Flushing usage events
[0m16:04:13.589432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:40.874595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED9F61A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED6BCF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED96209E0>]}


============================== 16:20:40.888053 | 12974cb0-1d0c-470f-8215-8fc2d62ef931 ==============================
[0m16:20:40.888053 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:20:40.889053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:41.777467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDA1E8DA0>]}
[0m16:20:41.829517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDA173470>]}
[0m16:20:41.832518 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:20:42.314371 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:20:42.315369 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:20:42.316368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDBCBC710>]}
[0m16:20:43.645136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m16:20:43.655940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDC12C5F0>]}
[0m16:20:43.742811 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:20:43.748789 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:20:43.804231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDC1D07A0>]}
[0m16:20:43.805233 [info ] [MainThread]: Found 1 model, 3 data tests, 2 sources, 586 macros
[0m16:20:43.806232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDC176120>]}
[0m16:20:43.808230 [info ] [MainThread]: 
[0m16:20:43.809230 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:20:43.810230 [info ] [MainThread]: 
[0m16:20:43.811230 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:43.814232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m16:20:44.088368 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m16:20:44.088368 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m16:20:44.088368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:48.364035 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.275 seconds
[0m16:20:48.370040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m16:20:48.387819 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m16:20:48.388836 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m16:20:48.388836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:50.392790 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.003 seconds
[0m16:20:50.395788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDC1F6510>]}
[0m16:20:50.415667 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m16:20:50.416665 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m16:20:50.418665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m16:20:50.419687 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m16:20:50.430095 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m16:20:50.436094 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m16:20:50.478843 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m16:20:50.481357 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m16:20:50.482358 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.

select *
from snowflake_sample_data.tpch_sf1.orders
  );
[0m16:20:50.482358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:52.479165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.997 seconds
[0m16:20:52.511746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12974cb0-1d0c-470f-8215-8fc2d62ef931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED9656780>]}
[0m16:20:52.512765 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.09s]
[0m16:20:52.513743 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m16:20:52.517848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:52.517848 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m16:20:52.518845 [debug] [MainThread]: On list_dbt_db: Close
[0m16:20:53.195721 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m16:20:53.196719 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m16:20:53.907962 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m16:20:53.908954 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m16:20:54.625139 [info ] [MainThread]: 
[0m16:20:54.626139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m16:20:54.629138 [debug] [MainThread]: Command end result
[0m16:20:54.662514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:20:54.665045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:20:54.673243 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m16:20:54.674245 [info ] [MainThread]: 
[0m16:20:54.675240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:54.676239 [info ] [MainThread]: 
[0m16:20:54.677248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:54.679242 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:54.678240 after 14.05 seconds
[0m16:20:54.679242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDC081460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EDBEB2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ED9DC8A40>]}
[0m16:20:54.679242 [debug] [MainThread]: Flushing usage events
[0m16:20:56.740506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:32.488370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05B6C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05B6CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05B6FA10>]}


============================== 16:29:32.497663 | 3633d64c-66d3-47f3-a35e-6ca96714aca8 ==============================
[0m16:29:32.497663 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:29:32.498657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_tpch_line_items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:32.983934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C02FA5B80>]}
[0m16:29:33.028073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05D31AC0>]}
[0m16:29:33.029764 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:29:33.449574 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:29:33.764052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:29:33.765202 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\staging\stg_tpch_line_items.sql
[0m16:29:33.766200 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\staging\stg_tpch_orders.sql
[0m16:29:34.075570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m16:29:34.089108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07B51A00>]}
[0m16:29:34.172232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:29:34.175233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:29:34.202697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07B9A210>]}
[0m16:29:34.202697 [info ] [MainThread]: Found 3 data tests, 2 models, 2 sources, 586 macros
[0m16:29:34.203706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C078044A0>]}
[0m16:29:34.205705 [info ] [MainThread]: 
[0m16:29:34.205705 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:29:34.206702 [info ] [MainThread]: 
[0m16:29:34.206702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:34.208702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m16:29:34.364366 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m16:29:34.364366 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m16:29:34.364366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:36.469829 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.105 seconds
[0m16:29:36.479851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m16:29:36.491278 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m16:29:36.491278 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m16:29:36.492291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:38.457851 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.966 seconds
[0m16:29:38.459849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C03337FB0>]}
[0m16:29:38.470362 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m16:29:38.471385 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m16:29:38.473651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m16:29:38.473651 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m16:29:38.480574 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m16:29:38.481573 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m16:29:38.512042 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m16:29:38.514551 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m16:29:38.514551 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m16:29:38.514551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:40.577983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m16:29:40.592787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3633d64c-66d3-47f3-a35e-6ca96714aca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05046960>]}
[0m16:29:40.593795 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.12s]
[0m16:29:40.594450 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m16:29:40.596464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:40.596464 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m16:29:40.596464 [debug] [MainThread]: On list_dbt_db: Close
[0m16:29:41.289970 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m16:29:41.289970 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m16:29:41.949048 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m16:29:41.950051 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m16:29:42.644087 [info ] [MainThread]: 
[0m16:29:42.646161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m16:29:42.647992 [debug] [MainThread]: Command end result
[0m16:29:42.672920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:29:42.677652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:29:42.686169 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m16:29:42.686169 [info ] [MainThread]: 
[0m16:29:42.687172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:42.688170 [info ] [MainThread]: 
[0m16:29:42.689170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:29:42.690171 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:42.690171 after 10.45 seconds
[0m16:29:42.691190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C057ABD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C04C43DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0538E330>]}
[0m16:29:42.691190 [debug] [MainThread]: Flushing usage events
[0m16:29:44.342504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:16.265715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181B71F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181B71F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181B71FD40>]}


============================== 16:36:16.276278 | d0b59900-7e4a-4489-8ea9-30a246bcaac1 ==============================
[0m16:36:16.276278 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:36:16.277295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s int_order_items', 'send_anonymous_usage_stats': 'True'}
[0m16:36:16.764799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021818AF6000>]}
[0m16:36:16.827065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181B779310>]}
[0m16:36:16.829066 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:36:17.318360 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:36:17.529228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:36:17.530741 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\int_order_items.sql
[0m16:36:17.760734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m16:36:17.772361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D66D760>]}
[0m16:36:17.857609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:36:17.862646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:36:17.902029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D40DC10>]}
[0m16:36:17.903048 [info ] [MainThread]: Found 3 data tests, 3 models, 2 sources, 586 macros
[0m16:36:17.903048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D75E360>]}
[0m16:36:17.904053 [info ] [MainThread]: 
[0m16:36:17.905730 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:36:17.906584 [info ] [MainThread]: 
[0m16:36:17.908650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:17.910586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m16:36:18.068771 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m16:36:18.069773 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m16:36:18.069773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:20.171041 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.102 seconds
[0m16:36:20.178606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m16:36:20.186352 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m16:36:20.187357 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m16:36:20.187357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:22.086613 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.899 seconds
[0m16:36:22.092613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D40EC00>]}
[0m16:36:22.105832 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m16:36:22.107842 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_order_items ......................... [RUN]
[0m16:36:22.108844 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m16:36:22.109851 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m16:36:22.119139 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m16:36:22.122119 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m16:36:22.144241 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m16:36:22.149283 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m16:36:22.150284 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace   view dbt_db.dbt_schema.int_order_items
  
   as (
    select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    orders.order_key,
    orders.customer_key,
    orders.order_date
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
  );
[0m16:36:22.150284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:24.120851 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9e6fa-3201-6302-0000-000b94b6e311
[0m16:36:24.122057 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'ORDERS.ORDER_KEY'
[0m16:36:24.130833 [debug] [Thread-1 (]: Database Error in model int_order_items (models\marts\int_order_items.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS.ORDER_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items.sql
[0m16:36:24.132835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0b59900-7e4a-4489-8ea9-30a246bcaac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181DC2F6E0>]}
[0m16:36:24.133836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.int_order_items ................ [[31mERROR[0m in 2.02s]
[0m16:36:24.136615 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m16:36:24.137632 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.int_order_items' to be skipped because of status 'error'.  Reason: Database Error in model int_order_items (models\marts\int_order_items.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS.ORDER_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items.sql.
[0m16:36:24.140615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:24.140615 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m16:36:24.140615 [debug] [MainThread]: On list_dbt_db: Close
[0m16:36:24.792815 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m16:36:24.793811 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m16:36:25.451328 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m16:36:25.452316 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m16:36:26.130081 [info ] [MainThread]: 
[0m16:36:26.132065 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m16:36:26.134065 [debug] [MainThread]: Command end result
[0m16:36:26.167869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m16:36:26.173362 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m16:36:26.179076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m16:36:26.179076 [info ] [MainThread]: 
[0m16:36:26.180609 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:36:26.181622 [info ] [MainThread]: 
[0m16:36:26.182621 [error] [MainThread]:   Database Error in model int_order_items (models\marts\int_order_items.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'ORDERS.ORDER_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items.sql
[0m16:36:26.184620 [info ] [MainThread]: 
[0m16:36:26.186125 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:36:26.188133 [debug] [MainThread]: Command `dbt run` failed at 16:36:26.188133 after 10.21 seconds
[0m16:36:26.189132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D5124E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181ABFC800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181ABFC410>]}
[0m16:36:26.189132 [debug] [MainThread]: Flushing usage events
[0m16:36:27.833855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:26.863077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71DFBF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D720F7C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72047D820>]}


============================== 18:09:26.875683 | 04e3330e-55db-421d-a794-04092a88eca0 ==============================
[0m18:09:26.875683 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:09:26.877007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_tpch_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:09:27.619260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71E915B80>]}
[0m18:09:27.677115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D72107DEB0>]}
[0m18:09:27.678119 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:09:28.116601 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:09:28.372801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:28.373824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:28.377134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m18:09:28.404563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D721522ED0>]}
[0m18:09:28.474465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:09:28.480465 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:09:28.528873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7233F2FC0>]}
[0m18:09:28.529868 [info ] [MainThread]: Found 3 data tests, 3 models, 2 sources, 586 macros
[0m18:09:28.529868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7232ADEE0>]}
[0m18:09:28.531887 [info ] [MainThread]: 
[0m18:09:28.531887 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:09:28.532870 [info ] [MainThread]: 
[0m18:09:28.533870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:09:28.535873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:09:28.701033 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:09:28.701033 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m18:09:28.702301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:31.327729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.626 seconds
[0m18:09:31.332724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:09:31.339724 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:09:31.339724 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:09:31.339724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:33.099116 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.759 seconds
[0m18:09:33.102410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D721EEB8C0>]}
[0m18:09:33.114409 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m18:09:33.115412 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m18:09:33.116407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m18:09:33.116407 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m18:09:33.121630 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m18:09:33.123105 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m18:09:33.145669 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m18:09:33.148191 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m18:09:33.148191 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m18:09:33.148191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:35.316333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.168 seconds
[0m18:09:35.336806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04e3330e-55db-421d-a794-04092a88eca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D720A069C0>]}
[0m18:09:35.336806 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.22s]
[0m18:09:35.337803 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m18:09:35.340734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:35.341764 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:09:35.342760 [debug] [MainThread]: On list_dbt_db: Close
[0m18:09:35.998374 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:09:35.999365 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:09:36.664415 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m18:09:36.664415 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m18:09:37.319813 [info ] [MainThread]: 
[0m18:09:37.320787 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m18:09:37.322022 [debug] [MainThread]: Command end result
[0m18:09:37.338398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:09:37.341421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:09:37.346397 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:09:37.346686 [info ] [MainThread]: 
[0m18:09:37.347716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:37.347716 [info ] [MainThread]: 
[0m18:09:37.348820 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:09:37.349695 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:37.349695 after 10.88 seconds
[0m18:09:37.350702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D720E57D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D720C06000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7212B59A0>]}
[0m18:09:37.350702 [debug] [MainThread]: Flushing usage events
[0m18:09:40.727548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:23.881955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2860CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2860E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2860EE70>]}


============================== 18:10:23.885956 | d41e145c-50a2-404d-8216-725cda416edb ==============================
[0m18:10:23.885956 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:10:23.886985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s int_order_items', 'send_anonymous_usage_stats': 'True'}
[0m18:10:24.245451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A286EA600>]}
[0m18:10:24.287490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28EA9640>]}
[0m18:10:24.288482 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:10:24.646748 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:10:24.795993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:24.795993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:24.799996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m18:10:24.832065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A15EF30>]}
[0m18:10:24.890049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:10:24.894044 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:10:24.915055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A533170>]}
[0m18:10:24.915055 [info ] [MainThread]: Found 3 data tests, 3 models, 2 sources, 586 macros
[0m18:10:24.916047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A506030>]}
[0m18:10:24.917058 [info ] [MainThread]: 
[0m18:10:24.918057 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:10:24.919084 [info ] [MainThread]: 
[0m18:10:24.919391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:10:24.920405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:10:25.033912 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:10:25.033912 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m18:10:25.034910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:26.899582 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.865 seconds
[0m18:10:26.905961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:10:26.912963 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:10:26.912963 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:10:26.912963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:28.698644 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.786 seconds
[0m18:10:28.701891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2A15B6E0>]}
[0m18:10:28.707667 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m18:10:28.707667 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_order_items ......................... [RUN]
[0m18:10:28.708667 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m18:10:28.708667 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m18:10:28.713684 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m18:10:28.715667 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m18:10:28.740844 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m18:10:28.741841 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m18:10:28.742842 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace   view dbt_db.dbt_schema.int_order_items
  
   as (
    select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    orders.order_key,
    orders.customer_key,
    orders.order_date
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
  );
[0m18:10:28.742842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:30.649785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.907 seconds
[0m18:10:30.664952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd41e145c-50a2-404d-8216-725cda416edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A27AD6DB0>]}
[0m18:10:30.665950 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_order_items .................... [[32mSUCCESS 1[0m in 1.96s]
[0m18:10:30.666799 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m18:10:30.669642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:30.669642 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:10:30.669642 [debug] [MainThread]: On list_dbt_db: Close
[0m18:10:31.321521 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:10:31.322522 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:10:31.979999 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m18:10:31.980996 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m18:10:32.642513 [info ] [MainThread]: 
[0m18:10:32.643512 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m18:10:32.644510 [debug] [MainThread]: Command end result
[0m18:10:32.663821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:10:32.666827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:10:32.672092 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:10:32.672092 [info ] [MainThread]: 
[0m18:10:32.672657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:32.673673 [info ] [MainThread]: 
[0m18:10:32.673673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:10:32.675726 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:32.675726 after 8.99 seconds
[0m18:10:32.676684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A27F4BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A257EAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2863FB90>]}
[0m18:10:32.676684 [debug] [MainThread]: Flushing usage events
[0m18:10:33.965721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:54.602461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B14F8F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B3E94620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B1E058B0>]}


============================== 18:26:54.611901 | f64753a8-1039-4eea-92b1-a82b8f8735d9 ==============================
[0m18:26:54.611901 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:26:54.612901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s int_order_items', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:55.338134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B3F27EF0>]}
[0m18:26:55.382451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B52CBC20>]}
[0m18:26:55.383451 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:26:55.797587 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:26:56.056559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:26:56.057565 [debug] [MainThread]: Partial parsing: added file: data_pipeline://macros\pricing.sql
[0m18:26:56.057565 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\int_order_items.sql
[0m18:26:56.257401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m18:26:56.268959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6A7E450>]}
[0m18:26:56.343127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:26:56.349147 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:26:56.403505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6A8D760>]}
[0m18:26:56.403505 [info ] [MainThread]: Found 3 data tests, 3 models, 2 sources, 587 macros
[0m18:26:56.404593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6856750>]}
[0m18:26:56.406605 [info ] [MainThread]: 
[0m18:26:56.407604 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:26:56.408604 [info ] [MainThread]: 
[0m18:26:56.409604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:26:56.411155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:26:56.662499 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:26:56.663498 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m18:26:56.663498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:59.052381 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.388 seconds
[0m18:26:59.064502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:26:59.074915 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:26:59.074915 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:26:59.075921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:01.124622 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.049 seconds
[0m18:27:01.130646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B68553D0>]}
[0m18:27:01.142464 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m18:27:01.144466 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_order_items ......................... [RUN]
[0m18:27:01.145665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m18:27:01.146679 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m18:27:01.163523 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m18:27:01.165738 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m18:27:01.200495 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m18:27:01.202498 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m18:27:01.203498 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace   view dbt_db.dbt_schema.int_order_items
  
   as (
    select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
  );
[0m18:27:01.204497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:03.753279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.549 seconds
[0m18:27:03.791525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f64753a8-1039-4eea-92b1-a82b8f8735d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B3F26990>]}
[0m18:27:03.792525 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_order_items .................... [[32mSUCCESS 1[0m in 2.64s]
[0m18:27:03.793038 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m18:27:03.797584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:03.797584 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:27:03.798581 [debug] [MainThread]: On list_dbt_db: Close
[0m18:27:04.554873 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:27:04.555766 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:27:05.355729 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m18:27:05.356734 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m18:27:06.132346 [info ] [MainThread]: 
[0m18:27:06.132346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.72 seconds (9.72s).
[0m18:27:06.134587 [debug] [MainThread]: Command end result
[0m18:27:06.149331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:27:06.152492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:27:06.157634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:27:06.157634 [info ] [MainThread]: 
[0m18:27:06.157634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:06.157634 [info ] [MainThread]: 
[0m18:27:06.157634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:27:06.162925 [debug] [MainThread]: Command `dbt run` succeeded at 18:27:06.162925 after 11.83 seconds
[0m18:27:06.162925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6AEFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6AEE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1B6AEFFE0>]}
[0m18:27:06.162925 [debug] [MainThread]: Flushing usage events
[0m18:27:08.595596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:05.813660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243174FFE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243170A1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431703C6E0>]}


============================== 14:45:05.830483 | 8b875ecb-5c55-4beb-96a7-1a2c9143b31f ==============================
[0m14:45:05.830483 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:45:05.831848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:45:06.624522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243148D5D30>]}
[0m14:45:06.679754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024316EBF0B0>]}
[0m14:45:06.681755 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:45:07.083003 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:45:07.382207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m14:45:07.383207 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\int_order_items_summary.sql
[0m14:45:07.383207 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\fct_order.sql
[0m14:45:07.383207 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\int_order_items.sql
[0m14:45:07.384207 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://macros\pricing.sql
[0m14:45:07.580541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:45:07.590544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431938FF20>]}
[0m14:45:07.651990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:45:07.667354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:45:07.717866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243194D6450>]}
[0m14:45:07.717866 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:45:07.718869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024319212450>]}
[0m14:45:07.719869 [info ] [MainThread]: 
[0m14:45:07.721197 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:45:07.721197 [info ] [MainThread]: 
[0m14:45:07.722199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:07.726199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m14:45:08.027117 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m14:45:08.028120 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m14:45:08.028120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:14.589838 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 6.562 seconds
[0m14:45:14.597357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m14:45:14.615360 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m14:45:14.615360 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m14:45:14.616359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:16.796137 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.188 seconds
[0m14:45:16.796137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431496A7E0>]}
[0m14:45:16.828827 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m14:45:16.830830 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m14:45:16.831895 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m14:45:16.834829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m14:45:16.835829 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m14:45:16.861225 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m14:45:16.832847 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m14:45:16.863240 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m14:45:16.864240 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m14:45:16.871669 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m14:45:16.873485 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m14:45:16.891967 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m14:45:16.901723 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m14:45:16.905729 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m14:45:16.907723 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m14:45:16.908723 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m14:45:16.908723 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:16.912724 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m14:45:16.912724 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m14:45:16.912724 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:19.046194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.141 seconds
[0m14:45:19.090997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243169C6840>]}
[0m14:45:19.092000 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.25s]
[0m14:45:19.093256 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m14:45:19.190445 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.282 seconds
[0m14:45:19.195874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024319C17B90>]}
[0m14:45:19.196874 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.33s]
[0m14:45:19.199059 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m14:45:19.201398 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m14:45:19.202393 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_schema.int_order_items ......................... [RUN]
[0m14:45:19.204375 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m14:45:19.205374 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m14:45:19.212377 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m14:45:19.215373 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m14:45:19.220701 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m14:45:19.227610 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m14:45:19.228610 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace   view dbt_db.dbt_schema.int_order_items
  
   as (
    select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
  );
[0m14:45:19.228610 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:21.345449 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.120 seconds
[0m14:45:21.345449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b875ecb-5c55-4beb-96a7-1a2c9143b31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024319C164B0>]}
[0m14:45:21.345449 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_schema.int_order_items .................... [[32mSUCCESS 1[0m in 2.14s]
[0m14:45:21.345449 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m14:45:21.362841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:21.363842 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m14:45:21.363842 [debug] [MainThread]: On list_dbt_db: Close
[0m14:45:22.036879 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m14:45:22.037881 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m14:45:22.701442 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m14:45:22.702444 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m14:45:23.390990 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m14:45:23.392837 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m14:45:24.063895 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m14:45:24.064898 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m14:45:24.737255 [info ] [MainThread]: 
[0m14:45:24.739260 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 17.02 seconds (17.02s).
[0m14:45:24.743156 [debug] [MainThread]: Command end result
[0m14:45:24.785894 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:45:24.788894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:45:24.795918 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:45:24.796923 [info ] [MainThread]: 
[0m14:45:24.797924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:24.798923 [info ] [MainThread]: 
[0m14:45:24.799925 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:45:24.800925 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:24.800925 after 19.26 seconds
[0m14:45:24.801925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024316ABD700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243152D1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243152D16D0>]}
[0m14:45:24.801925 [debug] [MainThread]: Flushing usage events
[0m14:45:26.673355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:24.077816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E78F8E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E78C078C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E78F8D880>]}


============================== 14:51:24.095082 | 910a61fe-3fe8-43b0-8825-7953e7be2293 ==============================
[0m14:51:24.095082 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:51:24.096355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:24.143868 [info ] [MainThread]: dbt version: 1.9.1
[0m14:51:24.144876 [info ] [MainThread]: python version: 3.12.8
[0m14:51:24.146048 [info ] [MainThread]: python path: C:\Training\DBTpractice\dbt-env\Scripts\python.exe
[0m14:51:24.146048 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m14:51:24.917981 [info ] [MainThread]: Using profiles dir at C:\Users\6133179\.dbt
[0m14:51:24.918984 [info ] [MainThread]: Using profiles.yml file at C:\Users\6133179\.dbt\profiles.yml
[0m14:51:24.919376 [info ] [MainThread]: Using dbt_project.yml file at C:\Training\DBTpractice\data_pipeline\dbt_project.yml
[0m14:51:24.920928 [info ] [MainThread]: adapter type: snowflake
[0m14:51:24.920928 [info ] [MainThread]: adapter version: 1.9.0
[0m14:51:24.997301 [info ] [MainThread]: Configuration:
[0m14:51:24.998552 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:51:24.999540 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:51:25.000559 [info ] [MainThread]: Required dependencies:
[0m14:51:25.000559 [debug] [MainThread]: Executing "git --help"
[0m14:51:25.011889 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:51:25.012870 [info ] [MainThread]: Connection:
[0m14:51:25.014170 [info ] [MainThread]:   account: izcbqdj-dq35992
[0m14:51:25.015171 [info ] [MainThread]:   user: RPANDEY
[0m14:51:25.015171 [info ] [MainThread]:   database: dbt_db
[0m14:51:25.016173 [info ] [MainThread]:   warehouse: dbt_wh
[0m14:51:25.017170 [info ] [MainThread]:   role: dbt_role
[0m14:51:25.018178 [info ] [MainThread]:   schema: dbt_schema
[0m14:51:25.019170 [info ] [MainThread]:   authenticator: None
[0m14:51:25.020171 [info ] [MainThread]:   oauth_client_id: None
[0m14:51:25.021171 [info ] [MainThread]:   query_tag: None
[0m14:51:25.022169 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:51:25.023169 [info ] [MainThread]:   host: None
[0m14:51:25.024169 [info ] [MainThread]:   port: None
[0m14:51:25.025169 [info ] [MainThread]:   proxy_host: None
[0m14:51:25.026169 [info ] [MainThread]:   proxy_port: None
[0m14:51:25.027169 [info ] [MainThread]:   protocol: None
[0m14:51:25.028169 [info ] [MainThread]:   connect_retries: 1
[0m14:51:25.029168 [info ] [MainThread]:   connect_timeout: None
[0m14:51:25.030174 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:51:25.030174 [info ] [MainThread]:   retry_all: False
[0m14:51:25.031173 [info ] [MainThread]:   insecure_mode: False
[0m14:51:25.032174 [info ] [MainThread]:   reuse_connections: True
[0m14:51:25.033174 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:51:25.446579 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:51:25.583283 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:51:25.583283 [debug] [MainThread]: On debug: select 1 as id
[0m14:51:25.583283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:27.644919 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.061 seconds
[0m14:51:27.646647 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:51:27.649193 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:51:27.650206 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m14:51:27.654903 [debug] [MainThread]: Command `dbt debug` failed at 14:51:27.653890 after 3.88 seconds
[0m14:51:27.654903 [debug] [MainThread]: Connection 'debug' was left open.
[0m14:51:27.654903 [debug] [MainThread]: On debug: Close
[0m14:51:28.330259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E7AB3B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E76D615E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E75961E50>]}
[0m14:51:28.331260 [debug] [MainThread]: Flushing usage events
[0m14:51:29.815696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:02.594199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220C4ED100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220E6E3CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220E6E0E30>]}


============================== 14:53:02.598467 | 5ed46f45-0ff9-4a5b-926d-bdfc6d043e17 ==============================
[0m14:53:02.598467 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:53:02.599225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_order', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:02.967338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed46f45-0ff9-4a5b-926d-bdfc6d043e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220E717F50>]}
[0m14:53:03.006005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed46f45-0ff9-4a5b-926d-bdfc6d043e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F1453A0>]}
[0m14:53:03.007009 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:53:03.345670 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:53:03.545612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:03.545612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:03.545612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:53:03.584168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed46f45-0ff9-4a5b-926d-bdfc6d043e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022210DACFB0>]}
[0m14:53:03.643283 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:53:03.648599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:53:03.672935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ed46f45-0ff9-4a5b-926d-bdfc6d043e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022210F66B10>]}
[0m14:53:03.673935 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:53:03.673935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed46f45-0ff9-4a5b-926d-bdfc6d043e17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022211179160>]}
[0m14:53:03.674936 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:53:03.676959 [debug] [MainThread]: Command end result
[0m14:53:03.692215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:53:03.696114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:53:03.699120 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:53:03.700137 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:03.700137 after 1.31 seconds
[0m14:53:03.700137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002221114BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220E72C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F253EF0>]}
[0m14:53:03.701121 [debug] [MainThread]: Flushing usage events
[0m14:53:05.158323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:14.498756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC60DCA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC60DFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC60DD1C0>]}


============================== 14:56:14.509752 | d8fddb7a-77f2-44dd-9c82-cf16b0fff71e ==============================
[0m14:56:14.509752 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:56:14.511751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_order_items', 'send_anonymous_usage_stats': 'True'}
[0m14:56:14.935319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC60DF9B0>]}
[0m14:56:15.000173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC6113440>]}
[0m14:56:15.001173 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:56:15.413245 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:56:15.587753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:15.589131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:15.593310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:56:15.625227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC64D99A0>]}
[0m14:56:15.690586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:15.694588 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:15.718926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC7DC6E40>]}
[0m14:56:15.719926 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:56:15.720925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC8028590>]}
[0m14:56:15.721924 [info ] [MainThread]: 
[0m14:56:15.722197 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:56:15.723207 [info ] [MainThread]: 
[0m14:56:15.724204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:15.726224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m14:56:15.848325 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m14:56:15.848325 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m14:56:15.848325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:17.836678 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.983 seconds
[0m14:56:17.845887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m14:56:17.865659 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m14:56:17.866666 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m14:56:17.866666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:19.746299 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.887 seconds
[0m14:56:19.760228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC802A390>]}
[0m14:56:19.777942 [debug] [Thread-1 (]: Began running node model.data_pipeline.int_order_items
[0m14:56:19.778945 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_order_items ......................... [RUN]
[0m14:56:19.781011 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m14:56:19.782006 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.int_order_items
[0m14:56:19.793579 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m14:56:19.797006 [debug] [Thread-1 (]: Began executing node model.data_pipeline.int_order_items
[0m14:56:19.836203 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m14:56:19.838206 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m14:56:19.838206 [debug] [Thread-1 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace   view dbt_db.dbt_schema.int_order_items
  
   as (
    select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
  );
[0m14:56:19.839201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:56:21.946192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.107 seconds
[0m14:56:21.976537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8fddb7a-77f2-44dd-9c82-cf16b0fff71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC55A6930>]}
[0m14:56:21.977525 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_order_items .................... [[32mSUCCESS 1[0m in 2.20s]
[0m14:56:21.978524 [debug] [Thread-1 (]: Finished running node model.data_pipeline.int_order_items
[0m14:56:21.981525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:21.982526 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m14:56:21.982526 [debug] [MainThread]: On list_dbt_db: Close
[0m14:56:22.666864 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m14:56:22.668172 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m14:56:23.346373 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m14:56:23.346373 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m14:56:24.018381 [info ] [MainThread]: 
[0m14:56:24.021001 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m14:56:24.023078 [debug] [MainThread]: Command end result
[0m14:56:24.056293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:24.059231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:24.064748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:56:24.064748 [info ] [MainThread]: 
[0m14:56:24.065748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:24.065748 [info ] [MainThread]: 
[0m14:56:24.067255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:24.069590 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:24.069590 after 9.85 seconds
[0m14:56:24.069590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC32B5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC5C5BA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC5C5A930>]}
[0m14:56:24.070732 [debug] [MainThread]: Flushing usage events
[0m14:56:25.784055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:34.557380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A99BFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A76A6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A755FFB0>]}


============================== 14:56:34.566376 | c696e8c1-8fe4-48bd-af57-1a9da8bdb70a ==============================
[0m14:56:34.566376 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:56:34.567377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_order_item_summary', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:35.005429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c696e8c1-8fe4-48bd-af57-1a9da8bdb70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208AA32BFE0>]}
[0m14:56:35.062809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c696e8c1-8fe4-48bd-af57-1a9da8bdb70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208AA1B8950>]}
[0m14:56:35.064809 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:56:35.504244 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:56:35.687586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:35.687586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:35.692593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:56:35.731931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c696e8c1-8fe4-48bd-af57-1a9da8bdb70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A9A99160>]}
[0m14:56:35.795692 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:35.798692 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:35.822694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c696e8c1-8fe4-48bd-af57-1a9da8bdb70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208AB647050>]}
[0m14:56:35.822694 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:56:35.823735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c696e8c1-8fe4-48bd-af57-1a9da8bdb70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208AA40B200>]}
[0m14:56:35.824691 [warn ] [MainThread]: The selection criterion 'int_order_item_summary' does not match any enabled nodes
[0m14:56:35.825691 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:56:35.827691 [debug] [MainThread]: Command end result
[0m14:56:35.845811 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:35.847801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:35.850801 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:56:35.851682 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:35.851682 after 1.56 seconds
[0m14:56:35.851682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A9495F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A94FF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A94FDD30>]}
[0m14:56:35.852699 [debug] [MainThread]: Flushing usage events
[0m14:56:36.945857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:46.112393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E18085040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E18B81880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E18B81850>]}


============================== 14:56:46.117385 | 1fa5760c-2a58-479a-b3c7-540b80c4a801 ==============================
[0m14:56:46.117385 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:56:46.118686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_order', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:46.535234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fa5760c-2a58-479a-b3c7-540b80c4a801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1B6389E0>]}
[0m14:56:46.583360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fa5760c-2a58-479a-b3c7-540b80c4a801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1B6F0470>]}
[0m14:56:46.584352 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:56:47.009887 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:56:47.194330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:47.194330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:47.198544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:56:47.233977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fa5760c-2a58-479a-b3c7-540b80c4a801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1B7DF410>]}
[0m14:56:47.298525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:47.302036 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:47.326445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fa5760c-2a58-479a-b3c7-540b80c4a801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1CC93110>]}
[0m14:56:47.326445 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:56:47.327465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fa5760c-2a58-479a-b3c7-540b80c4a801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1CC67FB0>]}
[0m14:56:47.328464 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:56:47.331464 [debug] [MainThread]: Command end result
[0m14:56:47.349019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:56:47.351020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:56:47.352191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:56:47.352191 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:47.352191 after 1.44 seconds
[0m14:56:47.352191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E184EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1AC4BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E1ADE7830>]}
[0m14:56:47.352191 [debug] [MainThread]: Flushing usage events
[0m14:56:48.425713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:30.702316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125B337920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125B337950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125A530620>]}


============================== 14:57:30.707337 | 2d4bb564-1920-4aac-b90e-e1b82483805d ==============================
[0m14:57:30.707337 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:57:30.708316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_tpch_line_items', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:57:31.071805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125BD494F0>]}
[0m14:57:31.115974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021257B88470>]}
[0m14:57:31.117180 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:57:31.488284 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:57:31.647599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:31.648602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:31.651599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:57:31.676157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D1642F0>]}
[0m14:57:31.738056 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:57:31.742059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:57:31.765062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D232F60>]}
[0m14:57:31.765062 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:57:31.766062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D2B76E0>]}
[0m14:57:31.767063 [info ] [MainThread]: 
[0m14:57:31.768258 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:57:31.768822 [info ] [MainThread]: 
[0m14:57:31.769829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:31.770827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m14:57:31.886251 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m14:57:31.886251 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m14:57:31.887251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:33.800513 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.914 seconds
[0m14:57:33.808297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m14:57:33.818788 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m14:57:33.819035 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m14:57:33.819035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:35.646506 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.837 seconds
[0m14:57:35.664465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D004BF0>]}
[0m14:57:35.680943 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m14:57:35.680943 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m14:57:35.682943 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m14:57:35.683961 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m14:57:35.705936 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m14:57:35.707935 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m14:57:35.735602 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m14:57:35.736603 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m14:57:35.736603 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m14:57:35.737604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:37.701230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.964 seconds
[0m14:57:37.739369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4bb564-1920-4aac-b90e-e1b82483805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125A936450>]}
[0m14:57:37.739369 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.05s]
[0m14:57:37.741362 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m14:57:37.744359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:37.745359 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m14:57:37.745359 [debug] [MainThread]: On list_dbt_db: Close
[0m14:57:38.425976 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m14:57:38.426975 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m14:57:39.117385 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m14:57:39.118384 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m14:57:39.779596 [info ] [MainThread]: 
[0m14:57:39.782128 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m14:57:39.784190 [debug] [MainThread]: Command end result
[0m14:57:39.903520 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:57:39.908522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:57:39.916046 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:57:39.916046 [info ] [MainThread]: 
[0m14:57:39.917042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:39.918225 [info ] [MainThread]: 
[0m14:57:39.918438 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:57:39.920622 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:39.920622 after 9.41 seconds
[0m14:57:39.920622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125B0A8B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D8108F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D810E60>]}
[0m14:57:39.921629 [debug] [MainThread]: Flushing usage events
[0m14:57:41.676005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:04.929492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC6CDDA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC3F5F2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC3F5EF90>]}


============================== 14:58:04.933493 | 4bfa10cc-b8e2-4edd-972e-b4705d0a9705 ==============================
[0m14:58:04.933493 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:58:04.934492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s pricing', 'send_anonymous_usage_stats': 'True'}
[0m14:58:05.270849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bfa10cc-b8e2-4edd-972e-b4705d0a9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC778F230>]}
[0m14:58:05.312877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bfa10cc-b8e2-4edd-972e-b4705d0a9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC76D91F0>]}
[0m14:58:05.314895 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:58:05.646315 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:58:05.815324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:05.815324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:05.819572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.data_pipeline.example
[0m14:58:05.846234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bfa10cc-b8e2-4edd-972e-b4705d0a9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC8830D40>]}
[0m14:58:05.906999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:58:05.910972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:58:05.932739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bfa10cc-b8e2-4edd-972e-b4705d0a9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC8C10BC0>]}
[0m14:58:05.932739 [info ] [MainThread]: Found 3 data tests, 5 models, 2 sources, 587 macros
[0m14:58:05.933739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bfa10cc-b8e2-4edd-972e-b4705d0a9705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC8ACCE90>]}
[0m14:58:05.933739 [warn ] [MainThread]: The selection criterion 'pricing' does not match any enabled nodes
[0m14:58:05.935044 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:58:05.937163 [debug] [MainThread]: Command end result
[0m14:58:05.951585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m14:58:05.954425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m14:58:05.957340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m14:58:05.958360 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:05.958360 after 1.23 seconds
[0m14:58:05.958360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4818CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC6260E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC6260F20>]}
[0m14:58:05.958360 [debug] [MainThread]: Flushing usage events
[0m14:58:07.129324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:00.076531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3A731040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3B231820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B39CEA4E0>]}


============================== 15:11:00.089550 | fb0cc50d-59c7-450c-9bbf-cedfae475f68 ==============================
[0m15:11:00.089550 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:11:00.091606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:11:00.115874 [info ] [MainThread]: dbt version: 1.9.1
[0m15:11:00.117890 [info ] [MainThread]: python version: 3.12.8
[0m15:11:00.119136 [info ] [MainThread]: python path: C:\Training\DBTpractice\dbt-env\Scripts\python.exe
[0m15:11:00.120121 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:11:00.479913 [info ] [MainThread]: Using profiles dir at C:\Users\6133179\.dbt
[0m15:11:00.480855 [info ] [MainThread]: Using profiles.yml file at C:\Users\6133179\.dbt\profiles.yml
[0m15:11:00.482221 [info ] [MainThread]: Using dbt_project.yml file at C:\Training\DBTpractice\data_pipeline\dbt_project.yml
[0m15:11:00.482964 [info ] [MainThread]: adapter type: snowflake
[0m15:11:00.483974 [info ] [MainThread]: adapter version: 1.9.0
[0m15:11:00.569801 [info ] [MainThread]: Configuration:
[0m15:11:00.570806 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:00.571806 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:00.572807 [info ] [MainThread]: Required dependencies:
[0m15:11:00.573385 [debug] [MainThread]: Executing "git --help"
[0m15:11:00.583905 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:11:00.583905 [info ] [MainThread]: Connection:
[0m15:11:00.584922 [info ] [MainThread]:   account: izcbqdj-dq35992
[0m15:11:00.585909 [info ] [MainThread]:   user: RPANDEY
[0m15:11:00.586906 [info ] [MainThread]:   database: dbt_db
[0m15:11:00.586906 [info ] [MainThread]:   warehouse: dbt_wh
[0m15:11:00.587906 [info ] [MainThread]:   role: dbt_role
[0m15:11:00.588410 [info ] [MainThread]:   schema: dbt_schema
[0m15:11:00.589417 [info ] [MainThread]:   authenticator: None
[0m15:11:00.590422 [info ] [MainThread]:   oauth_client_id: None
[0m15:11:00.590422 [info ] [MainThread]:   query_tag: None
[0m15:11:00.590422 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:11:00.591421 [info ] [MainThread]:   host: None
[0m15:11:00.593423 [info ] [MainThread]:   port: None
[0m15:11:00.594422 [info ] [MainThread]:   proxy_host: None
[0m15:11:00.596177 [info ] [MainThread]:   proxy_port: None
[0m15:11:00.597184 [info ] [MainThread]:   protocol: None
[0m15:11:00.597184 [info ] [MainThread]:   connect_retries: 1
[0m15:11:00.598182 [info ] [MainThread]:   connect_timeout: None
[0m15:11:00.598688 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:11:00.599693 [info ] [MainThread]:   retry_all: False
[0m15:11:00.599693 [info ] [MainThread]:   insecure_mode: False
[0m15:11:00.600693 [info ] [MainThread]:   reuse_connections: True
[0m15:11:00.603278 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:11:01.042934 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:11:01.189055 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:11:01.189055 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:01.189055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:03.196087 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.005 seconds
[0m15:11:03.199976 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:03.202047 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:11:03.202975 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:11:03.206924 [debug] [MainThread]: Command `dbt debug` failed at 15:11:03.206924 after 3.45 seconds
[0m15:11:03.207920 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:11:03.207920 [debug] [MainThread]: On debug: Close
[0m15:11:03.890142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3A9D2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3D806750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B3DE95A00>]}
[0m15:11:03.891157 [debug] [MainThread]: Flushing usage events
[0m15:11:05.326703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:58.286249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19221FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19221D7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19221FF20>]}


============================== 15:12:58.294771 | 4a93635d-892f-4463-b780-674319d1cc19 ==============================
[0m15:12:58.294771 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:12:58.294771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:58.317871 [info ] [MainThread]: dbt version: 1.9.1
[0m15:12:58.319139 [info ] [MainThread]: python version: 3.12.8
[0m15:12:58.320143 [info ] [MainThread]: python path: C:\Training\DBTpractice\dbt-env\Scripts\python.exe
[0m15:12:58.321142 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m15:12:58.684973 [info ] [MainThread]: Using profiles dir at C:\Users\6133179\.dbt
[0m15:12:58.685971 [info ] [MainThread]: Using profiles.yml file at C:\Users\6133179\.dbt\profiles.yml
[0m15:12:58.686973 [info ] [MainThread]: Using dbt_project.yml file at C:\Training\DBTpractice\data_pipeline\dbt_project.yml
[0m15:12:58.687971 [info ] [MainThread]: adapter type: snowflake
[0m15:12:58.688486 [info ] [MainThread]: adapter version: 1.9.0
[0m15:12:58.777143 [info ] [MainThread]: Configuration:
[0m15:12:58.778150 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:12:58.778150 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:12:58.779622 [info ] [MainThread]: Required dependencies:
[0m15:12:58.779622 [debug] [MainThread]: Executing "git --help"
[0m15:12:58.790012 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:12:58.791000 [info ] [MainThread]: Connection:
[0m15:12:58.792002 [info ] [MainThread]:   account: izcbqdj-dq35992
[0m15:12:58.792002 [info ] [MainThread]:   user: RPANDEY
[0m15:12:58.793003 [info ] [MainThread]:   database: dbt_db
[0m15:12:58.793003 [info ] [MainThread]:   warehouse: dbt_wh
[0m15:12:58.794003 [info ] [MainThread]:   role: dbt_role
[0m15:12:58.794999 [info ] [MainThread]:   schema: dbt_schema
[0m15:12:58.794999 [info ] [MainThread]:   authenticator: None
[0m15:12:58.796001 [info ] [MainThread]:   oauth_client_id: None
[0m15:12:58.797087 [info ] [MainThread]:   query_tag: None
[0m15:12:58.797087 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:12:58.798087 [info ] [MainThread]:   host: None
[0m15:12:58.799208 [info ] [MainThread]:   port: None
[0m15:12:58.800211 [info ] [MainThread]:   proxy_host: None
[0m15:12:58.800211 [info ] [MainThread]:   proxy_port: None
[0m15:12:58.801209 [info ] [MainThread]:   protocol: None
[0m15:12:58.801209 [info ] [MainThread]:   connect_retries: 1
[0m15:12:58.802208 [info ] [MainThread]:   connect_timeout: None
[0m15:12:58.803209 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:12:58.803209 [info ] [MainThread]:   retry_all: False
[0m15:12:58.804209 [info ] [MainThread]:   insecure_mode: False
[0m15:12:58.804209 [info ] [MainThread]:   reuse_connections: True
[0m15:12:58.805693 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:12:59.187072 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:12:59.283497 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:12:59.283497 [debug] [MainThread]: On debug: select 1 as id
[0m15:12:59.283497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:01.256924 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.973 seconds
[0m15:13:01.259472 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:13:01.262054 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:13:01.263054 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m15:13:01.267053 [debug] [MainThread]: Command `dbt debug` failed at 15:13:01.266054 after 3.24 seconds
[0m15:13:01.267053 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:13:01.268566 [debug] [MainThread]: On debug: Close
[0m15:13:01.953152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D192C3E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D192A6BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1943A68D0>]}
[0m15:13:01.954351 [debug] [MainThread]: Flushing usage events
[0m15:13:07.208024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:16.865930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2028D5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2032868A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F203284620>]}


============================== 15:13:16.870382 | 7e3caf41-a222-4bd1-9ef6-ef4cc6289b5d ==============================
[0m15:13:16.870382 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:13:16.871401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:13:17.218183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e3caf41-a222-4bd1-9ef6-ef4cc6289b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2029D5E50>]}
[0m15:13:17.260935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e3caf41-a222-4bd1-9ef6-ef4cc6289b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F205D71160>]}
[0m15:13:17.261936 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:13:17.617845 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:13:17.704454 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:17.705449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e3caf41-a222-4bd1-9ef6-ef4cc6289b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2073E4050>]}
[0m15:13:18.729076 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_pipeline.fct_order' (models\marts\fct_order.sql) depends on a node named 'stg_tpch_items_summary' which was not found
[0m15:13:18.731086 [debug] [MainThread]: Command `dbt run` failed at 15:13:18.731086 after 2.06 seconds
[0m15:13:18.731086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F204FBF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20761B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F207114FE0>]}
[0m15:13:18.732089 [debug] [MainThread]: Flushing usage events
[0m15:13:19.819072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:27.529222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5B50EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5BB6FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D58ACCFB0>]}


============================== 15:15:27.533730 | f554150d-2c9c-4d50-b9f8-891e37585cfe ==============================
[0m15:15:27.533730 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:15:27.534737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:27.886529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D59405BE0>]}
[0m15:15:27.930226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5C9CF2C0>]}
[0m15:15:27.931226 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:15:28.291945 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:15:28.352799 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:15:28.353902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5C013350>]}
[0m15:15:29.379044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5DDC6E10>]}
[0m15:15:29.435348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:15:29.439353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:15:29.461781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5DD756A0>]}
[0m15:15:29.461781 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:15:29.462598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5E1DF8C0>]}
[0m15:15:29.464109 [info ] [MainThread]: 
[0m15:15:29.464109 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:15:29.465116 [info ] [MainThread]: 
[0m15:15:29.466121 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:15:29.469121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m15:15:29.579207 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m15:15:29.579207 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m15:15:29.579207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:31.486746 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.907 seconds
[0m15:15:31.492726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:15:31.514881 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:15:31.515905 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:15:31.515905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:33.577463 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.061 seconds
[0m15:15:33.582464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5DE12C30>]}
[0m15:15:33.593995 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m15:15:33.594521 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m15:15:33.596535 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m15:15:33.597541 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m15:15:33.598554 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m15:15:33.609616 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m15:15:33.596535 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m15:15:33.611616 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m15:15:33.612616 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m15:15:33.618134 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m15:15:33.620133 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m15:15:33.642341 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m15:15:33.642341 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m15:15:33.647361 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m15:15:33.650361 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m15:15:33.650361 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m15:15:33.650361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:33.651360 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m15:15:33.651360 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m15:15:33.652361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:35.716174 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.064 seconds
[0m15:15:35.752601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D59404DA0>]}
[0m15:15:35.753616 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.14s]
[0m15:15:35.755338 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m15:15:35.757101 [debug] [Thread-4 (]: Began running node model.data_pipeline.fct_order
[0m15:15:35.758120 [info ] [Thread-4 (]: 3 of 4 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m15:15:35.760117 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m15:15:35.760117 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.fct_order
[0m15:15:35.763128 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m15:15:35.764629 [debug] [Thread-4 (]: Began executing node model.data_pipeline.fct_order
[0m15:15:35.783202 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m15:15:35.784200 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m15:15:35.785432 [debug] [Thread-4 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m15:15:35.785432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:15:35.969925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.319 seconds
[0m15:15:35.974434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5E800680>]}
[0m15:15:35.975445 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.38s]
[0m15:15:35.976446 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m15:15:35.978449 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items
[0m15:15:35.978449 [info ] [Thread-6 (]: 4 of 4 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m15:15:35.980446 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m15:15:35.981446 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items
[0m15:15:35.985960 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m15:15:35.987961 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items
[0m15:15:35.989960 [debug] [Thread-6 (]:  adapter: Dropping relation "DBT_DB"."DBT_SCHEMA"."INT_ORDER_ITEMS" because it is a view and target relation dbt_db.dbt_schema.int_order_items is of type table.
[0m15:15:36.000305 [debug] [Thread-6 (]: Applying DROP to: "DBT_DB"."DBT_SCHEMA"."INT_ORDER_ITEMS"
[0m15:15:36.007212 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:15:36.008214 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
drop view if exists "DBT_DB"."DBT_SCHEMA"."INT_ORDER_ITEMS" cascade
[0m15:15:36.008214 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:15:37.775467 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b9fd29-3201-6639-000b-94b60001d0f6
[0m15:15:37.776479 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_DB.DBT_SCHEMA.INT_ORDER_ITEMS_SUMMARY' does not exist or not authorized.
[0m15:15:37.786007 [debug] [Thread-4 (]: Database Error in model fct_order (models\marts\fct_order.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.DBT_SCHEMA.INT_ORDER_ITEMS_SUMMARY' does not exist or not authorized.
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql
[0m15:15:37.787011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5E8E3860>]}
[0m15:15:37.788015 [error] [Thread-4 (]: 3 of 4 ERROR creating sql table model dbt_schema.fct_order ..................... [[31mERROR[0m in 2.03s]
[0m15:15:37.790040 [debug] [Thread-4 (]: Finished running node model.data_pipeline.fct_order
[0m15:15:37.791005 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.fct_order' to be skipped because of status 'error'.  Reason: Database Error in model fct_order (models\marts\fct_order.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.DBT_SCHEMA.INT_ORDER_ITEMS_SUMMARY' does not exist or not authorized.
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql.
[0m15:15:38.023424 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.015 seconds
[0m15:15:38.025906 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m15:15:38.030535 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:15:38.032537 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m15:15:44.846633 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 6.813 seconds
[0m15:15:44.850858 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554150d-2c9c-4d50-b9f8-891e37585cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5E6D9370>]}
[0m15:15:44.851859 [info ] [Thread-6 (]: 4 of 4 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 8.87s]
[0m15:15:44.854476 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items
[0m15:15:44.860381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:44.861388 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m15:15:44.861388 [debug] [MainThread]: On list_dbt_db: Close
[0m15:15:45.566490 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:15:45.567494 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:15:46.231625 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m15:15:46.232630 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m15:15:46.912789 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m15:15:46.912789 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m15:15:47.600233 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m15:15:47.601234 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m15:15:48.281166 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m15:15:48.283166 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m15:15:48.957495 [info ] [MainThread]: 
[0m15:15:48.959500 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 19.49 seconds (19.49s).
[0m15:15:48.962517 [debug] [MainThread]: Command end result
[0m15:15:49.100402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:15:49.103401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:15:49.107897 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:15:49.107897 [info ] [MainThread]: 
[0m15:15:49.108888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:15:49.109887 [info ] [MainThread]: 
[0m15:15:49.110884 [error] [MainThread]:   Database Error in model fct_order (models\marts\fct_order.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_DB.DBT_SCHEMA.INT_ORDER_ITEMS_SUMMARY' does not exist or not authorized.
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql
[0m15:15:49.111884 [info ] [MainThread]: 
[0m15:15:49.112887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:15:49.115921 [debug] [MainThread]: Command `dbt run` failed at 15:15:49.115921 after 21.80 seconds
[0m15:15:49.117930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D588CC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5BABE840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D5B039FA0>]}
[0m15:15:49.118935 [debug] [MainThread]: Flushing usage events
[0m15:15:50.707421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:15.146945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234DDBCB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FFA57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FFA7200>]}


============================== 15:19:15.159159 | 55e67660-1929-4514-805d-9d71a7b6dee0 ==============================
[0m15:19:15.159159 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:19:15.160159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:15.685612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234DE9D7C0>]}
[0m15:19:15.728472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223509D69C0>]}
[0m15:19:15.729471 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:19:16.088452 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:19:16.251360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:16.251360 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\int_order_items_summary.sql
[0m15:19:16.497080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223529C9F70>]}
[0m15:19:16.561357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:19:16.564882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:19:16.594135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022352AA2420>]}
[0m15:19:16.595373 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:19:16.595373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223529C9A60>]}
[0m15:19:16.597420 [info ] [MainThread]: 
[0m15:19:16.597420 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:19:16.598525 [info ] [MainThread]: 
[0m15:19:16.598525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:16.602534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m15:19:16.755288 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m15:19:16.756304 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m15:19:16.756304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:18.788007 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.031 seconds
[0m15:19:18.794110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:19:18.807081 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:19:18.808082 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:19:18.808082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:20.743339 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.935 seconds
[0m15:19:20.750674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022352AB8080>]}
[0m15:19:20.775305 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m15:19:20.776315 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m15:19:20.777315 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m15:19:20.779312 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m15:19:20.780314 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m15:19:20.778315 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m15:19:20.799523 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m15:19:20.803031 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m15:19:20.804031 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m15:19:20.808550 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m15:19:20.810548 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m15:19:20.837086 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m15:19:20.838087 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m15:19:20.842087 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m15:19:20.843086 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m15:19:20.843086 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m15:19:20.844086 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m15:19:20.844086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:20.844086 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m15:19:20.848747 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:19:22.886316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.042 seconds
[0m15:19:22.940747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234FFA6090>]}
[0m15:19:22.940747 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.16s]
[0m15:19:22.944474 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m15:19:22.945342 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items_summary
[0m15:19:22.946310 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m15:19:22.947286 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m15:19:22.948523 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m15:19:22.948523 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m15:19:22.948523 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m15:19:22.972410 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m15:19:22.976670 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m15:19:22.977662 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_amount) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    item_key,
    order_key
        );
[0m15:19:22.977662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:19:23.019163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.171 seconds
[0m15:19:23.022141 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022350B13980>]}
[0m15:19:23.022141 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.22s]
[0m15:19:23.024141 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m15:19:23.024141 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items
[0m15:19:23.025611 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m15:19:23.026613 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m15:19:23.026613 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items
[0m15:19:23.031610 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m15:19:23.032610 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items
[0m15:19:23.034115 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m15:19:23.035120 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:19:23.035120 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m15:19:23.036127 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:19:24.967792 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b9fd2d-3201-6639-000b-94b60001d0fe
[0m15:19:24.968806 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 4
invalid identifier 'ITEM_KEY'
[0m15:19:24.978346 [debug] [Thread-4 (]: Database Error in model int_order_items_summary (models\marts\int_order_items_summary.sql)
  000904 (42000): SQL compilation error: error line 4 at position 4
  invalid identifier 'ITEM_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items_summary.sql
[0m15:19:24.979351 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223531B2060>]}
[0m15:19:24.980349 [error] [Thread-4 (]: 3 of 5 ERROR creating sql table model dbt_schema.int_order_items_summary ....... [[31mERROR[0m in 2.03s]
[0m15:19:24.982305 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m15:19:24.984324 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.int_order_items_summary' to be skipped because of status 'error'.  Reason: Database Error in model int_order_items_summary (models\marts\int_order_items_summary.sql)
  000904 (42000): SQL compilation error: error line 4 at position 4
  invalid identifier 'ITEM_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items_summary.sql.
[0m15:19:24.986896 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_order
[0m15:19:24.988892 [info ] [Thread-8 (]: 5 of 5 SKIP relation dbt_schema.fct_order ...................................... [[33mSKIP[0m]
[0m15:19:24.990893 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_order
[0m15:19:30.720065 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 7.684 seconds
[0m15:19:30.722444 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e67660-1929-4514-805d-9d71a7b6dee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002235319DDC0>]}
[0m15:19:30.723957 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 7.70s]
[0m15:19:30.724970 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items
[0m15:19:30.727976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:30.728973 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m15:19:30.728973 [debug] [MainThread]: On list_dbt_db: Close
[0m15:19:31.419537 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:19:31.420551 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:19:32.095562 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m15:19:32.096564 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m15:19:32.817609 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m15:19:32.818608 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m15:19:33.484425 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m15:19:33.485443 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m15:19:34.160466 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m15:19:34.161469 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m15:19:34.827492 [info ] [MainThread]: 
[0m15:19:34.829512 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 18.23 seconds (18.23s).
[0m15:19:34.832773 [debug] [MainThread]: Command end result
[0m15:19:34.867262 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:19:34.869263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:19:34.877423 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:19:34.878420 [info ] [MainThread]: 
[0m15:19:34.879418 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:19:34.880626 [info ] [MainThread]: 
[0m15:19:34.881625 [error] [MainThread]:   Database Error in model int_order_items_summary (models\marts\int_order_items_summary.sql)
  000904 (42000): SQL compilation error: error line 4 at position 4
  invalid identifier 'ITEM_KEY'
  compiled code at target\run\data_pipeline\models\marts\int_order_items_summary.sql
[0m15:19:34.883187 [info ] [MainThread]: 
[0m15:19:34.884186 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m15:19:34.885582 [debug] [MainThread]: Command `dbt run` failed at 15:19:34.885582 after 19.96 seconds
[0m15:19:34.885582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234DF806E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234E215130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234E81CA40>]}
[0m15:19:34.885582 [debug] [MainThread]: Flushing usage events
[0m15:19:36.693982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:43.725075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0B3EC980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0B28B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0B3ECE30>]}


============================== 15:22:43.741319 | 32a248e5-a248-410b-bfbc-599ce2710ff3 ==============================
[0m15:22:43.741319 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:22:43.742325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:44.203842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F087C5AF0>]}
[0m15:22:44.249630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0A8CE900>]}
[0m15:22:44.250630 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:22:44.606956 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:22:44.760254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:44.761255 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\int_order_items_summary.sql
[0m15:22:44.936223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D407230>]}
[0m15:22:44.991634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:22:44.995164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:22:45.017200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D4020C0>]}
[0m15:22:45.018225 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:22:45.019200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D2E6840>]}
[0m15:22:45.020200 [info ] [MainThread]: 
[0m15:22:45.021197 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:22:45.022199 [info ] [MainThread]: 
[0m15:22:45.022199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:45.025681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m15:22:45.136537 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m15:22:45.136537 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m15:22:45.137401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:47.118616 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.981 seconds
[0m15:22:47.124849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:22:47.146474 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:22:47.147474 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:22:47.148654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:49.145061 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.997 seconds
[0m15:22:49.151437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D1527E0>]}
[0m15:22:49.166125 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m15:22:49.168142 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m15:22:49.167132 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m15:22:49.171129 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m15:22:49.172129 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m15:22:49.170132 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m15:22:49.197243 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m15:22:49.198246 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m15:22:49.198246 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m15:22:49.200267 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m15:22:49.202247 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m15:22:49.226350 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m15:22:49.227349 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m15:22:49.230829 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m15:22:49.232530 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m15:22:49.232530 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m15:22:49.234121 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m15:22:49.234121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:22:49.235047 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m15:22:49.235047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:51.262926 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.029 seconds
[0m15:22:51.307617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F087C4BF0>]}
[0m15:22:51.308617 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.11s]
[0m15:22:51.310443 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m15:22:51.493356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.258 seconds
[0m15:22:51.498925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0D78CD40>]}
[0m15:22:51.499924 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.33s]
[0m15:22:51.501927 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m15:22:51.504452 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m15:22:51.505469 [debug] [Thread-5 (]: Began running node model.data_pipeline.int_order_items_summary
[0m15:22:51.506485 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m15:22:51.510487 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m15:22:51.511480 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m15:22:51.525520 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m15:22:51.508484 [info ] [Thread-5 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m15:22:51.528519 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m15:22:51.529522 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m15:22:51.530030 [debug] [Thread-5 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m15:22:51.559781 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m15:22:51.566307 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m15:22:51.569309 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:22:51.571308 [debug] [Thread-5 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m15:22:51.572308 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m15:22:51.575821 [debug] [Thread-5 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m15:22:51.575821 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:22:51.580348 [debug] [Thread-5 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m15:22:51.580348 [debug] [Thread-5 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    order_item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_percentage * extended_price) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    order_item_key,
    order_key
        );
[0m15:22:51.581346 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:22:58.362587 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 6.782 seconds
[0m15:22:58.368154 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0DAB1C70>]}
[0m15:22:58.369152 [info ] [Thread-5 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 6.84s]
[0m15:22:58.371153 [debug] [Thread-5 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m15:22:58.373155 [debug] [Thread-7 (]: Began running node model.data_pipeline.fct_order
[0m15:22:58.374160 [info ] [Thread-7 (]: 5 of 5 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m15:22:58.376712 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m15:22:58.377713 [debug] [Thread-7 (]: Began compiling node model.data_pipeline.fct_order
[0m15:22:58.385233 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m15:22:58.390242 [debug] [Thread-7 (]: Began executing node model.data_pipeline.fct_order
[0m15:22:58.394747 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m15:22:58.396761 [debug] [Thread-7 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m15:22:58.396761 [debug] [Thread-7 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m15:22:58.396761 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:22:59.822247 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 8.245 seconds
[0m15:22:59.825763 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0DA6FEF0>]}
[0m15:22:59.827776 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 8.32s]
[0m15:22:59.829779 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m15:23:03.206414 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 4.809 seconds
[0m15:23:03.209415 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32a248e5-a248-410b-bfbc-599ce2710ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0DA0EF60>]}
[0m15:23:03.210414 [info ] [Thread-7 (]: 5 of 5 OK created sql table model dbt_schema.fct_order ......................... [[32mSUCCESS 1[0m in 4.83s]
[0m15:23:03.212415 [debug] [Thread-7 (]: Finished running node model.data_pipeline.fct_order
[0m15:23:03.216928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:03.217928 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m15:23:03.217928 [debug] [MainThread]: On list_dbt_db: Close
[0m15:23:03.899180 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:23:03.900183 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:23:04.570500 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m15:23:04.571504 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m15:23:05.238118 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m15:23:05.239123 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m15:23:05.911248 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m15:23:05.912269 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m15:23:06.577690 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m15:23:06.578694 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m15:23:07.250174 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m15:23:07.251174 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m15:23:07.912213 [info ] [MainThread]: 
[0m15:23:07.914192 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 22.89 seconds (22.89s).
[0m15:23:07.917369 [debug] [MainThread]: Command end result
[0m15:23:07.942473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:23:07.946614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:23:07.956389 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:23:07.957384 [info ] [MainThread]: 
[0m15:23:07.958387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:07.959385 [info ] [MainThread]: 
[0m15:23:07.960384 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:23:07.961384 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:07.961384 after 24.48 seconds
[0m15:23:07.962384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0AF97AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0AF94B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F0BCF3020>]}
[0m15:23:07.962384 [debug] [MainThread]: Flushing usage events
[0m15:23:09.763215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:47.517009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8070620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E6264F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8BCB1A0>]}


============================== 15:28:47.524492 | ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce ==============================
[0m15:28:47.524492 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:28:47.525492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:28:48.010731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E917FEC0>]}
[0m15:28:48.069226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8FBCB60>]}
[0m15:28:48.070824 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:28:48.490767 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:28:48.741005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:28:48.742002 [debug] [MainThread]: Partial parsing: added file: data_pipeline://models\marts\generic_tests.yml
[0m15:28:48.806153 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\generic_tests.yml'
[0m15:28:48.928492 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m15:28:48.929495 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m15:28:48.930497 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m15:28:48.931492 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m15:28:49.037573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124EAF351F0>]}
[0m15:28:49.110865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:28:49.117841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:28:49.182738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124EB1C1130>]}
[0m15:28:49.183698 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:28:49.184740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124EB150560>]}
[0m15:28:49.185720 [info ] [MainThread]: 
[0m15:28:49.186702 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:28:49.188214 [info ] [MainThread]: 
[0m15:28:49.189749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:28:49.199724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:28:49.358784 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:28:49.358784 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:28:49.358784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:51.533903 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.175 seconds
[0m15:28:51.540903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea9c0e19-5ddc-4bd5-91ef-e8825de8bfce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E63FE8D0>]}
[0m15:28:51.546453 [debug] [Thread-1 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:28:51.546453 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:28:51.546453 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:28:51.546453 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:28:51.546453 [info ] [Thread-2 (]: 2 of 3 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:28:51.567805 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:28:51.573982 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:28:51.572984 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:28:51.593019 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:28:51.546453 [info ] [Thread-3 (]: 3 of 3 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:28:51.592501 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:28:51.598476 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:28:51.599477 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:28:51.601477 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:28:51.607476 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:28:51.609475 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:28:51.625224 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:28:51.626223 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:28:51.627223 [debug] [Thread-1 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:28:51.629730 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:28:51.631735 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:28:51.636741 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:28:51.637734 [debug] [Thread-2 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:28:51.637734 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:28:51.639735 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:28:51.639735 [debug] [Thread-3 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:28:51.639735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:28:51.642737 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:28:51.642894 [debug] [Thread-1 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:28:51.642894 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:53.964392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.321 seconds
[0m15:28:53.990606 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.42s]
[0m15:28:53.992594 [debug] [Thread-1 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:28:54.145995 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.507 seconds
[0m15:28:54.151884 [info ] [Thread-3 (]: 3 of 3 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.55s]
[0m15:28:54.153679 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:28:54.230415 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.592 seconds
[0m15:28:54.234075 [info ] [Thread-2 (]: 2 of 3 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.67s]
[0m15:28:54.237076 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:28:54.240177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:54.241179 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:28:54.242186 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:28:54.902693 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:28:54.903695 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:28:55.575310 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:28:55.576305 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:28:56.265937 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:28:56.266961 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:28:56.933873 [info ] [MainThread]: 
[0m15:28:56.935878 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m15:28:56.937876 [debug] [MainThread]: Command end result
[0m15:28:56.974610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:28:56.978631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:28:56.988638 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:28:56.988638 [info ] [MainThread]: 
[0m15:28:56.990125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:56.991144 [info ] [MainThread]: 
[0m15:28:56.992211 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:28:56.993425 [debug] [MainThread]: Command `dbt test` succeeded at 15:28:56.993425 after 9.70 seconds
[0m15:28:56.993425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8AD2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8AD1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124E8AD0F20>]}
[0m15:28:56.994427 [debug] [MainThread]: Flushing usage events
[0m15:28:58.646258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:35.077932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E405F4E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E403224E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E403224EF0>]}


============================== 15:35:35.094678 | 6696d6a4-97d1-45d6-9532-eb4a6afe3780 ==============================
[0m15:35:35.094678 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:35:35.096554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:35.646353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4057F4B00>]}
[0m15:35:35.698769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40344AA20>]}
[0m15:35:35.699771 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:35:36.098268 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:35:36.370992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:35:36.371997 [debug] [MainThread]: Partial parsing: added file: data_pipeline://tests\fct_orders_date_valid.sql
[0m15:35:36.371997 [debug] [MainThread]: Partial parsing: added file: data_pipeline://tests\fct_orders_discount.sql
[0m15:35:36.507965 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m15:35:36.509964 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m15:35:36.597523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40699BD70>]}
[0m15:35:36.674782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:35:36.679289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:35:36.721572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E408071760>]}
[0m15:35:36.722571 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:35:36.722571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4079956A0>]}
[0m15:35:36.725576 [info ] [MainThread]: 
[0m15:35:36.726574 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:35:36.726574 [info ] [MainThread]: 
[0m15:35:36.727572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:36.732639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:35:36.882013 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:35:36.882013 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:35:36.882013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:39.028342 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.145 seconds
[0m15:35:39.035341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6696d6a4-97d1-45d6-9532-eb4a6afe3780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E407A18320>]}
[0m15:35:39.048454 [debug] [Thread-1 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:35:39.049451 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:35:39.050447 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:35:39.051474 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:35:39.054328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:35:39.054328 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:35:39.052447 [info ] [Thread-2 (]: 2 of 3 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:35:39.053314 [info ] [Thread-3 (]: 3 of 3 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:35:39.074242 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:35:39.075300 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:35:39.075300 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:35:39.076296 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:35:39.077298 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:35:39.085523 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:35:39.090127 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:35:39.091130 [debug] [Thread-1 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:35:39.109143 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:35:39.110282 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:35:39.111297 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:35:39.112816 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:35:39.113831 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:35:39.114832 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:35:39.114832 [debug] [Thread-2 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:35:39.116343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:35:39.118366 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:35:39.118729 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:35:39.118729 [debug] [Thread-1 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:35:39.119729 [debug] [Thread-3 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:35:39.120728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:39.120728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:35:41.319820 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.198 seconds
[0m15:35:41.339669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.219 seconds
[0m15:35:41.337096 [info ] [Thread-3 (]: 3 of 3 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.26s]
[0m15:35:41.345860 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:35:41.343681 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.29s]
[0m15:35:41.346658 [debug] [Thread-1 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:35:41.383563 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.268 seconds
[0m15:35:41.387563 [info ] [Thread-2 (]: 2 of 3 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.31s]
[0m15:35:41.389564 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:35:41.393760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:41.394783 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:35:41.394783 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:35:42.104270 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:35:42.105270 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:35:42.785282 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:35:42.786288 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:35:43.476471 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:35:43.477475 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:35:44.145973 [info ] [MainThread]: 
[0m15:35:44.145973 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m15:35:44.145973 [debug] [MainThread]: Command end result
[0m15:35:44.199393 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:35:44.201416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:35:44.208277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:35:44.209280 [info ] [MainThread]: 
[0m15:35:44.210278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:44.211276 [info ] [MainThread]: 
[0m15:35:44.211276 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:35:44.213790 [debug] [MainThread]: Command `dbt test` succeeded at 15:35:44.213790 after 9.45 seconds
[0m15:35:44.214796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E405F327B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E403121D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E405416930>]}
[0m15:35:44.214796 [debug] [MainThread]: Flushing usage events
[0m15:35:45.693040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:28.323070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CC5073E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CC5077D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CC507710>]}


============================== 15:36:28.330060 | 4516e44c-94dd-4d48-a6ba-8d576d884588 ==============================
[0m15:36:28.330060 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:36:28.331591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:36:28.928315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CC870830>]}
[0m15:36:28.993349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CC4DB230>]}
[0m15:36:28.995344 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:36:29.499987 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:36:29.733396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:29.734396 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_discount.sql
[0m15:36:29.854635 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m15:36:29.949424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE67BB60>]}
[0m15:36:30.040900 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:36:30.045490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:36:30.111994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE637680>]}
[0m15:36:30.113007 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:36:30.113007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE3066F0>]}
[0m15:36:30.115006 [info ] [MainThread]: 
[0m15:36:30.116007 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:36:30.117007 [info ] [MainThread]: 
[0m15:36:30.118009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:30.122006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:36:30.313614 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:36:30.313614 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:36:30.314613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:32.521854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.208 seconds
[0m15:36:32.528871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4516e44c-94dd-4d48-a6ba-8d576d884588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE5BAAB0>]}
[0m15:36:32.549239 [debug] [Thread-1 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:36:32.550235 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:36:32.552769 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:36:32.551239 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:36:32.552769 [info ] [Thread-2 (]: 2 of 3 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:36:32.552769 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:36:32.552769 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:36:32.552769 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:36:32.552769 [info ] [Thread-3 (]: 3 of 3 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:36:32.561236 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:36:32.581843 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:36:32.581956 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:36:32.593523 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:36:32.593523 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:36:32.595797 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:36:32.595797 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:36:32.595797 [debug] [Thread-1 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:36:32.626210 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:36:32.629231 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:36:32.629788 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:36:32.633314 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:36:32.636311 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:36:32.637321 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:36:32.637321 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:36:32.638334 [debug] [Thread-2 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:36:32.638334 [debug] [Thread-1 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:36:32.639314 [debug] [Thread-3 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:36:32.639314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:36:32.639314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:32.639314 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:36:34.907118 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.267 seconds
[0m15:36:34.924220 [info ] [Thread-3 (]: 3 of 3 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.34s]
[0m15:36:34.926220 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:36:35.573260 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.934 seconds
[0m15:36:35.578263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.939 seconds
[0m15:36:35.577260 [info ] [Thread-2 (]: 2 of 3 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 3.02s]
[0m15:36:35.584108 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:36:35.581836 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 3.03s]
[0m15:36:35.587109 [debug] [Thread-1 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:36:35.591342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:35.591855 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:36:35.592937 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:36:36.267752 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:36:36.268752 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:36:36.960532 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:36:36.962060 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:36:37.654512 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:36:37.655515 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:36:38.323964 [info ] [MainThread]: 
[0m15:36:38.325955 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m15:36:38.329038 [debug] [MainThread]: Command end result
[0m15:36:38.362578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:36:38.365589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:36:38.374100 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:36:38.375099 [info ] [MainThread]: 
[0m15:36:38.376115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:38.377100 [info ] [MainThread]: 
[0m15:36:38.378110 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:36:38.378110 [debug] [MainThread]: Command `dbt test` succeeded at 15:36:38.378110 after 10.36 seconds
[0m15:36:38.379615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CA37C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE637EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CE637C80>]}
[0m15:36:38.379615 [debug] [MainThread]: Flushing usage events
[0m15:36:39.487164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:58.267245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E302F4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E324F12E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E324F0050>]}


============================== 15:36:58.277827 | 01082f68-d8f2-4d40-8e59-2c433a5ddb94 ==============================
[0m15:36:58.277827 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:36:58.280019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:36:58.701238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33928FB0>]}
[0m15:36:58.744146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E33A35D30>]}
[0m15:36:58.745151 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:36:59.186480 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:36:59.365629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:59.366627 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_discount.sql
[0m15:36:59.445568 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.fct_orders_discount' (tests\fct_orders_discount.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m15:36:59.543272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E34B9D760>]}
[0m15:36:59.630961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:36:59.634960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:36:59.700067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E34BC81A0>]}
[0m15:36:59.701068 [info ] [MainThread]: Found 5 models, 3 data tests, 2 sources, 587 macros
[0m15:36:59.702069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35008D70>]}
[0m15:36:59.706070 [info ] [MainThread]: 
[0m15:36:59.707069 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:36:59.707069 [info ] [MainThread]: 
[0m15:36:59.708071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:59.715067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:36:59.889080 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:36:59.889080 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:36:59.889080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:02.068439 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.176 seconds
[0m15:37:02.073687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01082f68-d8f2-4d40-8e59-2c433a5ddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E35233BC0>]}
[0m15:37:02.084307 [debug] [Thread-1 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:37:02.085332 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:37:02.087309 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:37:02.085332 [info ] [Thread-1 (]: 1 of 3 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:37:02.090308 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:37:02.086314 [info ] [Thread-2 (]: 2 of 3 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:37:02.091308 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:37:02.092308 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:37:02.103309 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:37:02.088312 [info ] [Thread-3 (]: 3 of 3 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:37:02.116324 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:37:02.123300 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:37:02.125334 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:37:02.126299 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:37:02.134625 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:37:02.135626 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:37:02.162054 [debug] [Thread-1 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:37:02.186194 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:37:02.190194 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:37:02.191195 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:37:02.193195 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:37:02.195194 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:37:02.195194 [debug] [Thread-3 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:37:02.195194 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:37:02.198195 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:37:02.198195 [debug] [Thread-1 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:37:02.199195 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:37:02.200194 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:02.200194 [debug] [Thread-2 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:37:02.201195 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:37:04.477065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.277 seconds
[0m15:37:04.493539 [info ] [Thread-1 (]: 1 of 3 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.40s]
[0m15:37:04.496541 [debug] [Thread-1 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:37:04.554415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.358 seconds
[0m15:37:04.556804 [info ] [Thread-3 (]: 3 of 3 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.43s]
[0m15:37:04.557814 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:37:04.718249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.517 seconds
[0m15:37:04.723247 [info ] [Thread-2 (]: 2 of 3 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.63s]
[0m15:37:04.725246 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:37:04.729929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:04.730928 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:37:04.730928 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:37:05.408010 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:37:05.409015 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:37:06.078040 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:37:06.079061 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:37:07.127147 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:37:07.128146 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:37:07.804310 [info ] [MainThread]: 
[0m15:37:07.806294 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m15:37:07.809295 [debug] [MainThread]: Command end result
[0m15:37:07.842369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:37:07.845369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:37:07.846450 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:37:07.846450 [info ] [MainThread]: 
[0m15:37:07.846450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:07.853187 [info ] [MainThread]: 
[0m15:37:07.854693 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:37:07.856699 [debug] [MainThread]: Command `dbt test` succeeded at 15:37:07.856699 after 9.87 seconds
[0m15:37:07.856699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E2F90CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E32EFB6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E330B05F0>]}
[0m15:37:07.857700 [debug] [MainThread]: Flushing usage events
[0m15:37:09.470355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:07.573041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CC935670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE0D0FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CC9356A0>]}


============================== 15:38:07.583041 | 6fd2b0ee-d945-4d76-9cc6-2e7ba075157d ==============================
[0m15:38:07.583041 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:38:07.585042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:08.206304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CF5B4B00>]}
[0m15:38:08.250573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE69CC80>]}
[0m15:38:08.250573 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:38:08.686340 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:38:08.945481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:08.945481 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_discount.sql
[0m15:38:09.124242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D065D760>]}
[0m15:38:09.217836 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:38:09.222466 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:38:09.313825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D0CD7D10>]}
[0m15:38:09.313825 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 587 macros
[0m15:38:09.314825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CF5B42F0>]}
[0m15:38:09.316820 [info ] [MainThread]: 
[0m15:38:09.317821 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:38:09.318123 [info ] [MainThread]: 
[0m15:38:09.319158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:09.328387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:38:09.526983 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:38:09.526983 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:38:09.526983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:11.699542 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.172 seconds
[0m15:38:11.707724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd2b0ee-d945-4d76-9cc6-2e7ba075157d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D0C9D0D0>]}
[0m15:38:11.717722 [debug] [Thread-1 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:38:11.719615 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:38:11.718610 [info ] [Thread-1 (]: 1 of 4 START test fct_orders_discount .......................................... [RUN]
[0m15:38:11.721481 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:38:11.722486 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:38:11.722486 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:38:11.723486 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:38:11.720614 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:38:11.731484 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:38:11.731484 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:38:11.723486 [info ] [Thread-3 (]: 3 of 4 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:38:11.733487 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:38:11.724505 [info ] [Thread-4 (]: 4 of 4 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:38:11.735486 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:38:11.749501 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:38:11.749501 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:38:11.749501 [debug] [Thread-1 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:38:11.749501 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:38:11.749501 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:38:11.769239 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:38:11.778209 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:38:11.778209 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:38:11.785720 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:38:11.787721 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:38:11.790719 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:38:11.791720 [debug] [Thread-2 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:38:11.792454 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:38:11.794460 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:38:11.797136 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:38:11.798128 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:38:11.800104 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:38:11.801103 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:38:11.801103 [debug] [Thread-4 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:38:11.802104 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:38:11.803107 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:38:11.804103 [debug] [Thread-1 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount < 0
      
    ) dbt_internal_test
[0m15:38:11.805145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:11.806104 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:38:11.808103 [debug] [Thread-3 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:38:11.808103 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:38:14.189906 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.397 seconds
[0m15:38:14.208666 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.400 seconds
[0m15:38:14.209651 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.48s]
[0m15:38:14.213652 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:38:14.212663 [info ] [Thread-3 (]: 3 of 4 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.48s]
[0m15:38:14.215652 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:38:14.322241 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.520 seconds
[0m15:38:14.325279 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.58s]
[0m15:38:14.327240 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:38:14.404202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.600 seconds
[0m15:38:14.406201 [info ] [Thread-1 (]: 1 of 4 PASS fct_orders_discount ................................................ [[32mPASS[0m in 2.68s]
[0m15:38:14.407201 [debug] [Thread-1 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:38:14.410201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:14.411201 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:38:14.412201 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:38:15.077982 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:38:15.078993 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:38:15.770216 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:38:15.770497 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:38:16.436776 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:38:16.437780 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:38:17.116560 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:38:17.117564 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:38:17.783970 [info ] [MainThread]: 
[0m15:38:17.785957 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m15:38:17.788949 [debug] [MainThread]: Command end result
[0m15:38:17.825477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:38:17.828478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:38:17.833623 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:38:17.833623 [info ] [MainThread]: 
[0m15:38:17.834961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:17.836005 [info ] [MainThread]: 
[0m15:38:17.836997 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:38:17.839981 [debug] [MainThread]: Command `dbt test` succeeded at 15:38:17.838977 after 10.58 seconds
[0m15:38:17.840405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDBE3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDBE1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDBE1670>]}
[0m15:38:17.840993 [debug] [MainThread]: Flushing usage events
[0m15:38:19.522893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:47.346045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71299D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7120437A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712043230>]}


============================== 15:39:47.371148 | 0347d8ca-a3e8-418a-8956-1886bb9a7ac0 ==============================
[0m15:39:47.371148 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:39:47.374153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:39:48.034108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E713164E60>]}
[0m15:39:48.086120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7134472F0>]}
[0m15:39:48.089120 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:39:48.537390 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:39:48.814112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:48.815113 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m15:39:49.049739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71499EF90>]}
[0m15:39:49.137780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:39:49.141781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:39:49.211233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712543E00>]}
[0m15:39:49.211233 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 587 macros
[0m15:39:49.211233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7148B1550>]}
[0m15:39:49.215936 [info ] [MainThread]: 
[0m15:39:49.216951 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:39:49.218255 [info ] [MainThread]: 
[0m15:39:49.220599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:39:49.226603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:39:49.368359 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:39:49.368359 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:39:49.369386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:51.578504 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.210 seconds
[0m15:39:51.584501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0347d8ca-a3e8-418a-8956-1886bb9a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7148C2660>]}
[0m15:39:51.596855 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:39:51.597856 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:39:51.599863 [debug] [Thread-3 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:39:51.600857 [debug] [Thread-4 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:39:51.596855 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m15:39:51.601879 [debug] [Thread-5 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:39:51.602857 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:39:51.603857 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m15:39:51.598861 [info ] [Thread-2 (]: 2 of 8 START test fct_orders_discount .......................................... [RUN]
[0m15:39:51.604858 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:39:51.599863 [info ] [Thread-3 (]: 3 of 8 START test not_null_fct_order_order_key ................................. [RUN]
[0m15:39:51.606857 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:39:51.607857 [debug] [Thread-8 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:39:51.607857 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:39:51.601879 [info ] [Thread-4 (]: 4 of 8 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m15:39:51.609887 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m15:39:51.604858 [info ] [Thread-5 (]: 5 of 8 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:39:51.619038 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:39:51.605857 [info ] [Thread-6 (]: 6 of 8 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:39:51.622038 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:39:51.622038 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m15:39:51.608856 [info ] [Thread-7 (]: 7 of 8 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:39:51.623073 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:39:51.624192 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:39:51.621038 [info ] [Thread-8 (]: 8 of 8 START test unique_fct_order_order_key ................................... [RUN]
[0m15:39:51.625200 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:39:51.628346 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:39:51.629375 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:39:51.629375 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:39:51.638390 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:39:51.638390 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:39:51.639389 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m15:39:51.640389 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:39:51.644584 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:39:51.644584 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:39:51.646091 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:39:51.653319 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:39:51.653319 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:39:51.654317 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:39:51.659318 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:39:51.666738 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:39:51.667737 [debug] [Thread-3 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:39:51.685295 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:39:51.688295 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:39:51.692296 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:39:51.692296 [debug] [Thread-4 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:39:51.694564 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:39:51.694564 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:39:51.696503 [debug] [Thread-5 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:39:51.697504 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:39:51.699509 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:39:51.702505 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:39:51.702505 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:39:51.704506 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:39:51.707506 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:39:51.708506 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:39:51.708506 [debug] [Thread-8 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:39:51.708506 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount < 0
      
    ) dbt_internal_test
[0m15:39:51.711017 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m15:39:51.712019 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:39:51.713023 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:39:51.716091 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:39:51.717093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:39:51.718091 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:39:51.718091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:51.720091 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:39:51.721098 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:39:51.722100 [debug] [Thread-3 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m15:39:51.722100 [debug] [Thread-7 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:39:51.723093 [debug] [Thread-5 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:39:51.725091 [debug] [Thread-6 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:39:51.727091 [debug] [Thread-4 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:39:51.727091 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:39:51.728090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:39:51.728090 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:39:51.728090 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:39:51.729091 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:39:51.730091 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:39:51.730091 [debug] [Thread-8 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m15:39:51.743102 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:39:54.118194 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.401 seconds
[0m15:39:54.134606 [info ] [Thread-2 (]: 2 of 8 PASS fct_orders_discount ................................................ [[32mPASS[0m in 2.53s]
[0m15:39:54.137595 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:39:54.183589 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9fd41-3201-65a7-000b-94b60001c16a
[0m15:39:54.183589 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m15:39:54.189579 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:39:54.190580 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.59s]
[0m15:39:54.191580 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:39:54.193580 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m15:39:54.230272 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.503 seconds
[0m15:39:54.234024 [info ] [Thread-3 (]: 3 of 8 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.62s]
[0m15:39:54.236024 [debug] [Thread-3 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:39:54.254216 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.525 seconds
[0m15:39:54.256216 [info ] [Thread-7 (]: 7 of 8 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.63s]
[0m15:39:54.258226 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:39:54.261216 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.532 seconds
[0m15:39:54.265745 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.537 seconds
[0m15:39:54.263748 [info ] [Thread-6 (]: 6 of 8 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.64s]
[0m15:39:54.268781 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:39:54.267745 [info ] [Thread-5 (]: 5 of 8 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.64s]
[0m15:39:54.269744 [debug] [Thread-5 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:39:54.395830 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.657 seconds
[0m15:39:54.395830 [error] [Thread-8 (]: 8 of 8 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.76s]
[0m15:39:54.395830 [debug] [Thread-8 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:39:54.508342 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.779 seconds
[0m15:39:54.512359 [info ] [Thread-4 (]: 4 of 8 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 2.89s]
[0m15:39:54.514877 [debug] [Thread-4 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:39:54.519163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:54.520182 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:39:54.521508 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:39:55.191393 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m15:39:55.192559 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m15:39:55.892580 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:39:55.893596 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:39:56.545931 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m15:39:56.545931 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m15:39:57.246275 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m15:39:57.246275 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m15:39:57.932244 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:39:57.933259 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:39:58.601023 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:39:58.602026 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:39:59.269381 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:39:59.270901 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:39:59.936441 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m15:39:59.937446 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m15:40:00.627745 [info ] [MainThread]: 
[0m15:40:00.629745 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 11.41 seconds (11.41s).
[0m15:40:00.633746 [debug] [MainThread]: Command end result
[0m15:40:00.663744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:40:00.667909 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:40:00.674738 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:40:00.674738 [info ] [MainThread]: 
[0m15:40:00.676118 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:40:00.676644 [info ] [MainThread]: 
[0m15:40:00.677665 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:40:00.678660 [info ] [MainThread]: 
[0m15:40:00.679663 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m15:40:00.680794 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m15:40:00.681794 [info ] [MainThread]: 
[0m15:40:00.681794 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m15:40:00.683369 [info ] [MainThread]: 
[0m15:40:00.683941 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m15:40:00.685958 [debug] [MainThread]: Command `dbt test` failed at 15:40:00.685958 after 13.64 seconds
[0m15:40:00.685958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7119721E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7119705C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FCF1460>]}
[0m15:40:00.687042 [debug] [MainThread]: Flushing usage events
[0m15:40:02.312299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:26.117893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEE89EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEE89EDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEE89E510>]}


============================== 15:40:26.121149 | 53546aff-1175-4903-9dcf-1df1fa2cec42 ==============================
[0m15:40:26.121149 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:40:26.122257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:40:26.470964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEC795CD0>]}
[0m15:40:26.514957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEFE72030>]}
[0m15:40:26.515972 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:40:26.850103 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:40:27.019657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:27.020658 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_discount.sql
[0m15:40:27.139883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DF1408B60>]}
[0m15:40:27.198322 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:40:27.202317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:40:27.237021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DF0F29280>]}
[0m15:40:27.237021 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 587 macros
[0m15:40:27.238008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DF0F19700>]}
[0m15:40:27.239014 [info ] [MainThread]: 
[0m15:40:27.240047 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:40:27.240047 [info ] [MainThread]: 
[0m15:40:27.241013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:27.245181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:40:27.357955 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:40:27.357955 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:40:27.357955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:29.389587 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.031 seconds
[0m15:40:29.397351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53546aff-1175-4903-9dcf-1df1fa2cec42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DF0F45AC0>]}
[0m15:40:29.423562 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:40:29.424561 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:40:29.425561 [debug] [Thread-3 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:40:29.427561 [debug] [Thread-4 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:40:29.428569 [debug] [Thread-5 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:40:29.426561 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m15:40:29.430560 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:40:29.431560 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:40:29.433561 [debug] [Thread-8 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:40:29.429561 [info ] [Thread-2 (]: 2 of 8 START test fct_orders_discount .......................................... [RUN]
[0m15:40:29.432560 [info ] [Thread-3 (]: 3 of 8 START test not_null_fct_order_order_key ................................. [RUN]
[0m15:40:29.437562 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m15:40:29.434629 [info ] [Thread-4 (]: 4 of 8 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m15:40:29.442571 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:40:29.443617 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m15:40:29.435561 [info ] [Thread-5 (]: 5 of 8 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:40:29.445559 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:40:29.439560 [info ] [Thread-6 (]: 6 of 8 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:40:29.446988 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m15:40:29.447990 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:40:29.440570 [info ] [Thread-7 (]: 7 of 8 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:40:29.450508 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:40:29.441561 [info ] [Thread-8 (]: 8 of 8 START test unique_fct_order_order_key ................................... [RUN]
[0m15:40:29.451524 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:40:29.466951 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:40:29.471327 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:40:29.471327 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:40:29.474339 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:40:29.475330 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:40:29.481835 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:40:29.483834 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m15:40:29.484839 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:40:29.485834 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:40:29.493205 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:40:29.494253 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:40:29.494253 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:40:29.495964 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:40:29.495964 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:40:29.499611 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:40:29.504626 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:40:29.509630 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:40:29.536622 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:40:29.536622 [debug] [Thread-3 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:40:29.539663 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:40:29.542623 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:40:29.542623 [debug] [Thread-4 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:40:29.547163 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:40:29.547163 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:40:29.548164 [debug] [Thread-5 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:40:29.550296 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:40:29.551289 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:40:29.554289 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:40:29.557292 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:40:29.558289 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:40:29.559295 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:40:29.559295 [debug] [Thread-8 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:40:29.560346 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m15:40:29.561290 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:40:29.562806 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:40:29.563822 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m15:40:29.565827 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:40:29.568309 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:40:29.569328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:29.570309 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:40:29.570309 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:40:29.571307 [debug] [Thread-3 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m15:40:29.571307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:40:29.572306 [debug] [Thread-5 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:40:29.574308 [debug] [Thread-4 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:40:29.575310 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:40:29.576309 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:40:29.576309 [debug] [Thread-7 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:29.576309 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:40:29.578309 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:40:29.578309 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:40:29.579309 [debug] [Thread-6 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:40:29.581314 [debug] [Thread-8 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:29.582339 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:40:29.589370 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:40:29.590310 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:40:32.045721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9fd42-3201-65a7-000b-94b60001c182
[0m15:40:32.045721 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m15:40:32.061884 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:40:32.063883 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.63s]
[0m15:40:32.065881 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:40:32.066879 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m15:40:32.075979 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.497 seconds
[0m15:40:32.083977 [info ] [Thread-4 (]: 4 of 8 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 2.64s]
[0m15:40:32.084977 [debug] [Thread-4 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:40:32.109765 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.538 seconds
[0m15:40:32.112790 [error] [Thread-2 (]: 2 of 8 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.67s]
[0m15:40:32.115380 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:40:32.124092 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.534 seconds
[0m15:40:32.126131 [error] [Thread-8 (]: 8 of 8 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.64s]
[0m15:40:32.127099 [debug] [Thread-8 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:40:32.142644 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.565 seconds
[0m15:40:32.144642 [info ] [Thread-5 (]: 5 of 8 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.69s]
[0m15:40:32.147828 [debug] [Thread-5 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:40:32.169071 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.592 seconds
[0m15:40:32.171576 [info ] [Thread-3 (]: 3 of 8 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.73s]
[0m15:40:32.172583 [debug] [Thread-3 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:40:32.188771 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.607 seconds
[0m15:40:32.192774 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.604 seconds
[0m15:40:32.190775 [info ] [Thread-7 (]: 7 of 8 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.72s]
[0m15:40:32.198769 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:40:32.196581 [info ] [Thread-6 (]: 6 of 8 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.73s]
[0m15:40:32.199585 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:40:32.204581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:32.204581 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:40:32.205590 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:40:32.871509 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m15:40:32.872024 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m15:40:33.537360 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:40:33.538360 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:40:34.219201 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m15:40:34.220199 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m15:40:34.888796 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m15:40:34.889797 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m15:40:35.549080 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:40:35.549080 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:40:36.246310 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:40:36.246310 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:40:36.956563 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:40:36.956563 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:40:37.622101 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m15:40:37.623108 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m15:40:38.439384 [info ] [MainThread]: 
[0m15:40:38.441371 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m15:40:38.444574 [debug] [MainThread]: Command end result
[0m15:40:38.477171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:40:38.485696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:40:38.495013 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:40:38.496525 [info ] [MainThread]: 
[0m15:40:38.497535 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:40:38.498545 [info ] [MainThread]: 
[0m15:40:38.498545 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:40:38.500547 [info ] [MainThread]: 
[0m15:40:38.501545 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m15:40:38.503548 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m15:40:38.503548 [info ] [MainThread]: 
[0m15:40:38.504548 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m15:40:38.505544 [info ] [MainThread]: 
[0m15:40:38.506543 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m15:40:38.506543 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m15:40:38.507545 [info ] [MainThread]: 
[0m15:40:38.509544 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m15:40:38.510545 [info ] [MainThread]: 
[0m15:40:38.510545 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m15:40:38.514059 [debug] [MainThread]: Command `dbt test` failed at 15:40:38.514059 after 12.59 seconds
[0m15:40:38.514059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEE58E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEC691130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DEC6911C0>]}
[0m15:40:38.515065 [debug] [MainThread]: Flushing usage events
[0m15:40:39.946010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:43.137256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398FA88260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023992B3E9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239929CB3B0>]}


============================== 15:41:43.145473 | 88e91374-a6c8-4a7d-8cbd-af4651e80da7 ==============================
[0m15:41:43.145473 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:41:43.145473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:41:43.646102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023993250B60>]}
[0m15:41:43.696406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002399390FDA0>]}
[0m15:41:43.698406 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:41:44.090106 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:41:44.261091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:44.262105 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_date_valid.sql
[0m15:41:44.410304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239951787A0>]}
[0m15:41:44.484912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:41:44.490910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:41:44.535441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239953F0200>]}
[0m15:41:44.535441 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m15:41:44.536441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002399522A690>]}
[0m15:41:44.540441 [info ] [MainThread]: 
[0m15:41:44.541441 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:41:44.541441 [info ] [MainThread]: 
[0m15:41:44.543441 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:41:44.553398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:41:44.703348 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:41:44.703348 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:41:44.704347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:46.806923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.102 seconds
[0m15:41:46.812926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e91374-a6c8-4a7d-8cbd-af4651e80da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002399522BD40>]}
[0m15:41:46.829515 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:41:46.830514 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m15:41:46.831514 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:41:46.833513 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:41:46.831514 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m15:41:46.834513 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:41:46.836517 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:41:46.835513 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m15:41:46.837513 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:41:46.838513 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:41:46.839518 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:41:46.838513 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m15:41:46.842587 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m15:41:46.840513 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m15:41:46.842780 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m15:41:46.846459 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m15:41:46.843785 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:41:46.848513 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:41:46.850064 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:41:46.851061 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:41:46.851061 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m15:41:46.853117 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:41:46.853117 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m15:41:46.855767 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m15:41:46.857785 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m15:41:46.857785 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:41:46.858781 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:41:46.858781 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:41:46.859828 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:41:46.860781 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m15:41:46.868766 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:41:46.877752 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:41:46.877752 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:41:46.881340 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m15:41:46.881340 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:41:46.882921 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:41:46.883868 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:41:46.886880 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:41:46.887865 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:41:46.895247 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:41:46.905040 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:41:46.908041 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:41:46.912040 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:41:46.917416 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:41:46.918678 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:41:46.921886 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:41:46.923924 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:41:46.923924 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m15:41:46.924879 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:41:46.930876 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:41:46.940877 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:41:46.941876 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:41:46.942872 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:41:46.944954 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:41:46.944954 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:41:46.946875 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m15:41:46.946875 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:41:46.950056 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:41:46.950056 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:41:46.950056 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:41:46.950056 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:41:46.950056 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:41:46.950056 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:41:46.950056 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:41:46.950056 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:41:46.950056 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m15:41:46.966156 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m15:41:46.967152 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:41:46.968356 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:41:46.968356 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:41:46.970416 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:41:46.971759 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:41:46.971759 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m15:41:46.972754 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:41:46.973752 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:41:46.973752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:46.974752 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:41:46.974752 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m15:41:46.975763 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m15:41:46.975763 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:41:46.977458 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:41:46.977458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:46.978468 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:46.978468 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:46.979467 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:41:46.983169 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:46.984184 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:46.984184 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:41:46.988682 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m15:41:46.988682 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:41:49.445307 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9fd43-3201-65a7-000b-94b60001c196
[0m15:41:49.445446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m15:41:49.452549 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:41:49.453547 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.61s]
[0m15:41:49.454668 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:41:49.455541 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m15:41:49.467460 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.491 seconds
[0m15:41:49.476975 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 2.62s]
[0m15:41:49.478974 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:41:49.488173 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.509 seconds
[0m15:41:49.489166 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.63s]
[0m15:41:49.491167 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:41:49.549937 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.566 seconds
[0m15:41:49.551936 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.70s]
[0m15:41:49.552936 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:41:49.557936 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.576 seconds
[0m15:41:49.559936 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.71s]
[0m15:41:49.560943 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:41:49.619390 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.631 seconds
[0m15:41:49.623265 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.76s]
[0m15:41:49.624265 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:41:49.627269 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.638 seconds
[0m15:41:49.631344 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.77s]
[0m15:41:49.633350 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:41:49.634344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.657 seconds
[0m15:41:49.638343 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.654 seconds
[0m15:41:49.637348 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 2.79s]
[0m15:41:49.641343 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m15:41:49.640347 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.78s]
[0m15:41:49.642343 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:41:49.646344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:49.646344 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:41:49.647673 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:41:50.311964 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m15:41:50.312968 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m15:41:50.999839 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m15:41:51.000840 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m15:41:51.673055 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:41:51.674054 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:41:52.353922 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m15:41:52.354900 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m15:41:53.078800 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m15:41:53.079798 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m15:41:53.767463 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:41:53.767557 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:41:54.942594 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:41:54.942594 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:41:55.651348 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:41:55.652455 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:41:56.316582 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m15:41:56.317585 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m15:41:57.048966 [info ] [MainThread]: 
[0m15:41:57.051645 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m15:41:57.054641 [debug] [MainThread]: Command end result
[0m15:41:57.082644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:41:57.086646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:41:57.091646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:41:57.092647 [info ] [MainThread]: 
[0m15:41:57.093530 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:41:57.094538 [info ] [MainThread]: 
[0m15:41:57.095308 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:41:57.096827 [info ] [MainThread]: 
[0m15:41:57.097833 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m15:41:57.099835 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m15:41:57.100832 [info ] [MainThread]: 
[0m15:41:57.101833 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m15:41:57.102833 [info ] [MainThread]: 
[0m15:41:57.103833 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m15:41:57.104809 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m15:41:57.105621 [info ] [MainThread]: 
[0m15:41:57.106640 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m15:41:57.107684 [info ] [MainThread]: 
[0m15:41:57.108689 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m15:41:57.110654 [debug] [MainThread]: Command `dbt test` failed at 15:41:57.110654 after 14.22 seconds
[0m15:41:57.110654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239903D1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239927BCCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023992690950>]}
[0m15:41:57.110654 [debug] [MainThread]: Flushing usage events
[0m15:41:58.939899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:07.869543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C851EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE79FECDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7A3789E0>]}


============================== 15:42:07.880544 | a631cb68-bab5-4e43-8499-6c398c76669e ==============================
[0m15:42:07.880544 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:42:07.881544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:42:08.318575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7D7559A0>]}
[0m15:42:08.371077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7A0E5AC0>]}
[0m15:42:08.372077 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:42:08.786551 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:42:08.964047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:08.965044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:08.997636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7D5ADF40>]}
[0m15:42:09.071045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:42:09.071045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:42:09.113320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7EB980E0>]}
[0m15:42:09.114316 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m15:42:09.114316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7E7CDA00>]}
[0m15:42:09.115826 [info ] [MainThread]: 
[0m15:42:09.116860 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:42:09.118137 [info ] [MainThread]: 
[0m15:42:09.119142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:09.124254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m15:42:09.246193 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m15:42:09.246193 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m15:42:09.246193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:11.305690 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.048 seconds
[0m15:42:11.312706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:42:11.330771 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:42:11.331771 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:42:11.331771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:13.337970 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.006 seconds
[0m15:42:13.345181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7E945B20>]}
[0m15:42:13.346257 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m15:42:13.346257 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m15:42:13.346257 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m15:42:13.364653 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m15:42:13.365656 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m15:42:13.370876 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m15:42:13.363113 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m15:42:13.370876 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m15:42:13.388681 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m15:42:13.388681 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m15:42:13.411703 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m15:42:13.415704 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m15:42:13.417703 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m15:42:13.419104 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m15:42:13.421106 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m15:42:13.421106 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m15:42:13.422613 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m15:42:13.422613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:13.423862 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m15:42:13.424327 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:15.607652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.185 seconds
[0m15:42:15.645949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7A0E4BF0>]}
[0m15:42:15.645949 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.28s]
[0m15:42:15.645949 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m15:42:15.645949 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items_summary
[0m15:42:15.645949 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m15:42:15.645949 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m15:42:15.645949 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m15:42:15.645949 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m15:42:15.645949 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m15:42:15.681537 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m15:42:15.682533 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m15:42:15.682533 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    order_item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_percentage * extended_price) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    order_item_key,
    order_key
        );
[0m15:42:15.682533 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:42:15.767170 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.343 seconds
[0m15:42:15.770311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F314320>]}
[0m15:42:15.770311 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.40s]
[0m15:42:15.772349 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m15:42:15.773350 [debug] [Thread-6 (]: Began running node model.data_pipeline.int_order_items
[0m15:42:15.774351 [info ] [Thread-6 (]: 4 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m15:42:15.774351 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m15:42:15.775351 [debug] [Thread-6 (]: Began compiling node model.data_pipeline.int_order_items
[0m15:42:15.845982 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m15:42:15.845982 [debug] [Thread-6 (]: Began executing node model.data_pipeline.int_order_items
[0m15:42:15.845982 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m15:42:15.854036 [debug] [Thread-6 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:42:15.854036 [debug] [Thread-6 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m15:42:15.855034 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:42:22.514222 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 6.831 seconds
[0m15:42:22.519694 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F31FFE0>]}
[0m15:42:22.520974 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 6.87s]
[0m15:42:22.522951 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m15:42:22.525021 [debug] [Thread-8 (]: Began running node model.data_pipeline.fct_order
[0m15:42:22.526042 [info ] [Thread-8 (]: 5 of 5 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m15:42:22.528038 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m15:42:22.529039 [debug] [Thread-8 (]: Began compiling node model.data_pipeline.fct_order
[0m15:42:22.536036 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m15:42:22.538564 [debug] [Thread-8 (]: Began executing node model.data_pipeline.fct_order
[0m15:42:22.545907 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m15:42:22.545907 [debug] [Thread-8 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m15:42:22.545907 [debug] [Thread-8 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m15:42:22.545907 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:42:23.704081 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 7.849 seconds
[0m15:42:23.708078 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F322450>]}
[0m15:42:23.709078 [info ] [Thread-6 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 7.93s]
[0m15:42:23.711063 [debug] [Thread-6 (]: Finished running node model.data_pipeline.int_order_items
[0m15:42:26.846904 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 4.306 seconds
[0m15:42:26.846904 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a631cb68-bab5-4e43-8499-6c398c76669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F1C1DF0>]}
[0m15:42:26.846904 [info ] [Thread-8 (]: 5 of 5 OK created sql table model dbt_schema.fct_order ......................... [[32mSUCCESS 1[0m in 4.32s]
[0m15:42:26.862936 [debug] [Thread-8 (]: Finished running node model.data_pipeline.fct_order
[0m15:42:26.868303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:26.869326 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m15:42:26.869326 [debug] [MainThread]: On list_dbt_db: Close
[0m15:42:27.527542 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:42:27.528544 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:42:28.204393 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m15:42:28.204393 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m15:42:28.907391 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m15:42:28.907391 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m15:42:29.575326 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m15:42:29.576326 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m15:42:30.239354 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m15:42:30.240368 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m15:42:30.930298 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m15:42:30.931298 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m15:42:31.604384 [info ] [MainThread]: 
[0m15:42:31.606381 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 22.49 seconds (22.49s).
[0m15:42:31.609395 [debug] [MainThread]: Command end result
[0m15:42:31.655323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:42:31.657331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:42:31.662838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:42:31.663845 [info ] [MainThread]: 
[0m15:42:31.664874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:31.665844 [info ] [MainThread]: 
[0m15:42:31.667088 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:42:31.668633 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:31.668633 after 24.07 seconds
[0m15:42:31.668633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7CB3A7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7BBC0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C929220>]}
[0m15:42:31.668633 [debug] [MainThread]: Flushing usage events
[0m15:42:33.070277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:54.899401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCA208E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCAD01460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCAD01520>]}


============================== 15:42:54.908395 | 2dc2578a-f601-4fab-81b8-df3839118c0e ==============================
[0m15:42:54.908395 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:42:54.909787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:55.346120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCCA3BFB0>]}
[0m15:42:55.416118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCA4C0E30>]}
[0m15:42:55.417496 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:42:55.881386 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:42:56.077955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:56.077955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:56.111474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCC826FF0>]}
[0m15:42:56.180224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:42:56.183243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:42:56.215183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCF0499D0>]}
[0m15:42:56.215183 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m15:42:56.216175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCD9D3440>]}
[0m15:42:56.221077 [info ] [MainThread]: 
[0m15:42:56.222078 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:42:56.222524 [info ] [MainThread]: 
[0m15:42:56.223528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:56.227611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:42:56.364363 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:42:56.365381 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:42:56.365381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:58.546187 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.186 seconds
[0m15:42:58.546187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc2578a-f601-4fab-81b8-df3839118c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCE9F53D0>]}
[0m15:42:58.570645 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:42:58.572831 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m15:42:58.574813 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:42:58.576812 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:42:58.573814 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m15:42:58.577826 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:42:58.579841 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:42:58.580937 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:42:58.575815 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m15:42:58.583958 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:42:58.584957 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m15:42:58.585956 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:42:58.578812 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m15:42:58.583016 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m15:42:58.586996 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:42:58.589524 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m15:42:58.588526 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m15:42:58.592527 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:42:58.593530 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m15:42:58.588526 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:42:58.594527 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m15:42:58.595525 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:42:58.596524 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m15:42:58.591526 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:42:58.596524 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:42:58.611866 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:42:58.593530 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m15:42:58.611866 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:42:58.612866 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:42:58.612866 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:42:58.614163 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:42:58.616165 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m15:42:58.617173 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:42:58.617173 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:42:58.618167 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m15:42:58.626897 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:42:58.626897 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:42:58.632453 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:42:58.633456 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:42:58.638453 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:42:58.639452 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:42:58.641453 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:42:58.641453 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:42:58.646254 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:42:58.646254 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m15:42:58.720543 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:42:58.741117 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:42:58.746325 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:42:58.746325 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:42:58.746325 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:42:58.746325 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:42:58.746325 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m15:42:58.746325 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:42:58.746325 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:42:58.746325 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:42:58.746325 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:42:58.762224 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:42:58.764220 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:42:58.764220 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:42:58.765219 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:42:58.767220 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:42:58.768366 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:42:58.770590 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m15:42:58.770590 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:42:58.770590 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m15:42:58.770590 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:42:58.770590 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:42:58.776430 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:42:58.776430 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:42:58.776430 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m15:42:58.776430 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m15:42:58.776430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:58.776430 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:42:58.776430 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:42:58.776430 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:42:58.776430 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:42:58.776430 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:58.776430 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:42:58.786444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:42:58.786955 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:42:58.787410 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:42:58.788427 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:42:58.789422 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m15:42:58.790421 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:42:58.790421 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:58.792709 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:58.793710 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:42:58.797211 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:42:58.799342 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:42:58.799876 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m15:43:01.289642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9fd45-3201-6639-000b-94b60001d1d2
[0m15:43:01.290653 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m15:43:01.300286 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:43:01.301283 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.72s]
[0m15:43:01.304266 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:43:01.305263 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m15:43:01.351107 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.565 seconds
[0m15:43:01.359104 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.76s]
[0m15:43:01.360105 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:43:01.421003 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.636 seconds
[0m15:43:01.424009 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 2.83s]
[0m15:43:01.426008 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m15:43:01.435966 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.646 seconds
[0m15:43:01.438989 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.84s]
[0m15:43:01.440967 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:43:01.443966 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.650 seconds
[0m15:43:01.445970 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.83s]
[0m15:43:01.447205 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:43:01.466821 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.668 seconds
[0m15:43:01.472025 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.86s]
[0m15:43:01.474022 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:43:01.597248 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.797 seconds
[0m15:43:01.601246 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.98s]
[0m15:43:01.604247 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:43:01.606265 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.809 seconds
[0m15:43:01.610246 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 3.01s]
[0m15:43:01.612248 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:43:01.728039 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.940 seconds
[0m15:43:01.732042 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 3.14s]
[0m15:43:01.734041 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:43:01.739728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:01.739728 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:43:01.740752 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:43:02.409159 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m15:43:02.410165 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m15:43:03.070371 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m15:43:03.070371 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m15:43:03.774970 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m15:43:03.775975 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m15:43:04.539417 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m15:43:04.540436 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m15:43:05.273465 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:43:05.274463 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:43:06.049666 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:43:06.049666 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:43:06.790489 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:43:06.791489 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:43:07.539070 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:43:07.540071 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:43:08.225678 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m15:43:08.225678 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m15:43:09.021284 [info ] [MainThread]: 
[0m15:43:09.021284 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 12.80 seconds (12.80s).
[0m15:43:09.037906 [debug] [MainThread]: Command end result
[0m15:43:09.075217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:43:09.080217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:43:09.089238 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:43:09.089238 [info ] [MainThread]: 
[0m15:43:09.090222 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:43:09.090222 [info ] [MainThread]: 
[0m15:43:09.091222 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:43:09.091222 [info ] [MainThread]: 
[0m15:43:09.092446 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m15:43:09.093447 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m15:43:09.093447 [info ] [MainThread]: 
[0m15:43:09.094447 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m15:43:09.094447 [info ] [MainThread]: 
[0m15:43:09.095446 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m15:43:09.096446 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m15:43:09.097448 [info ] [MainThread]: 
[0m15:43:09.099448 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m15:43:09.099448 [info ] [MainThread]: 
[0m15:43:09.100953 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m15:43:09.102958 [debug] [MainThread]: Command `dbt test` failed at 15:43:09.101960 after 14.45 seconds
[0m15:43:09.102958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCCE24620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCBFD77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FCAAF39E0>]}
[0m15:43:09.102958 [debug] [MainThread]: Flushing usage events
[0m15:43:10.743181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:14.730612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028983BC4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028983BC54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028983BC5460>]}


============================== 15:45:14.738626 | c40e794e-39a0-4cbb-ae18-0de94d47ac2c ==============================
[0m15:45:14.738626 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:45:14.739609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:15.160609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289863CD970>]}
[0m15:45:15.205182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028983BC5460>]}
[0m15:45:15.206190 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:45:15.663974 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:45:15.828988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:15.828988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:15.868368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002898687AE70>]}
[0m15:45:15.946143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:45:15.963180 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:45:15.987794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028987CF3740>]}
[0m15:45:15.987794 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m15:45:15.989794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028987A68AA0>]}
[0m15:45:15.993040 [info ] [MainThread]: 
[0m15:45:15.994045 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:45:15.995042 [info ] [MainThread]: 
[0m15:45:15.996051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:16.004040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m15:45:16.143244 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m15:45:16.144241 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m15:45:16.144241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:18.292913 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.149 seconds
[0m15:45:18.299207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:45:18.317512 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:45:18.317512 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:45:18.318517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:20.314053 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.995 seconds
[0m15:45:20.319312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289867CB6B0>]}
[0m15:45:20.331812 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m15:45:20.332812 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m15:45:20.333815 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m15:45:20.336814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m15:45:20.336814 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m15:45:20.361480 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m15:45:20.334813 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m15:45:20.362988 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m15:45:20.364000 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m15:45:20.369303 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m15:45:20.370370 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m15:45:20.402296 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m15:45:20.404300 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m15:45:20.409370 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m15:45:20.411371 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m15:45:20.412879 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m15:45:20.412879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:20.413892 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m15:45:20.413892 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m15:45:20.413892 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:22.567633 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.153 seconds
[0m15:45:22.597766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289831C4F20>]}
[0m15:45:22.598765 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.24s]
[0m15:45:22.600770 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m15:45:22.633901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.221 seconds
[0m15:45:22.637896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028985E20EF0>]}
[0m15:45:22.639889 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.30s]
[0m15:45:22.640573 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m15:45:22.642819 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m15:45:22.643833 [debug] [Thread-5 (]: Began running node model.data_pipeline.int_order_items_summary
[0m15:45:22.644968 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m15:45:22.647209 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m15:45:22.645978 [info ] [Thread-5 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m15:45:22.648216 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m15:45:22.649033 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m15:45:22.656678 [debug] [Thread-5 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m15:45:22.659028 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m15:45:22.662740 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m15:45:22.664749 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m15:45:22.757235 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m15:45:22.757235 [debug] [Thread-5 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m15:45:22.757235 [debug] [Thread-5 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m15:45:22.772860 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m15:45:22.773131 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m15:45:22.773131 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:22.776132 [debug] [Thread-5 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m15:45:22.777136 [debug] [Thread-5 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    order_item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_percentage * extended_price) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    order_item_key,
    order_key
        );
[0m15:45:22.778134 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:45:30.300353 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 7.523 seconds
[0m15:45:30.303350 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289883D6BA0>]}
[0m15:45:30.303350 [info ] [Thread-5 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 7.65s]
[0m15:45:30.305349 [debug] [Thread-5 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m15:45:30.306348 [debug] [Thread-7 (]: Began running node model.data_pipeline.fct_order
[0m15:45:30.307349 [info ] [Thread-7 (]: 5 of 5 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m15:45:30.308349 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m15:45:30.308349 [debug] [Thread-7 (]: Began compiling node model.data_pipeline.fct_order
[0m15:45:30.310373 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m15:45:30.311367 [debug] [Thread-7 (]: Began executing node model.data_pipeline.fct_order
[0m15:45:30.313373 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m15:45:30.313373 [debug] [Thread-7 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m15:45:30.314349 [debug] [Thread-7 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m15:45:30.314349 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:45:30.879183 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 8.106 seconds
[0m15:45:30.881182 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289883F4560>]}
[0m15:45:30.881182 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 8.24s]
[0m15:45:30.882191 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m15:45:34.714365 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 4.400 seconds
[0m15:45:34.716366 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40e794e-39a0-4cbb-ae18-0de94d47ac2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289882C7170>]}
[0m15:45:34.716366 [info ] [Thread-7 (]: 5 of 5 OK created sql table model dbt_schema.fct_order ......................... [[32mSUCCESS 1[0m in 4.41s]
[0m15:45:34.718365 [debug] [Thread-7 (]: Finished running node model.data_pipeline.fct_order
[0m15:45:34.721669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:34.721669 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m15:45:34.721669 [debug] [MainThread]: On list_dbt_db: Close
[0m15:45:35.388963 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:45:35.390265 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:45:36.061772 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m15:45:36.061772 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m15:45:36.749929 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m15:45:36.750929 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m15:45:37.403441 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m15:45:37.404442 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m15:45:38.093094 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m15:45:38.093094 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m15:45:38.774509 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m15:45:38.774509 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m15:45:39.489609 [info ] [MainThread]: 
[0m15:45:39.490941 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 23.49 seconds (23.49s).
[0m15:45:39.491947 [debug] [MainThread]: Command end result
[0m15:45:39.511978 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:45:39.515172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:45:39.521454 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:45:39.521454 [info ] [MainThread]: 
[0m15:45:39.522685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:39.523698 [info ] [MainThread]: 
[0m15:45:39.524694 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:45:39.526099 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:39.526099 after 25.04 seconds
[0m15:45:39.526099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028988392DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028988392E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028988393890>]}
[0m15:45:39.527110 [debug] [MainThread]: Flushing usage events
[0m15:45:41.147056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:48.904788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E4834F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E6FEF500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E6FEF8C0>]}


============================== 15:45:48.908790 | 9a329126-c436-4009-a243-81b12e4b7612 ==============================
[0m15:45:48.908790 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:45:48.909799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:49.245949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7F79D30>]}
[0m15:45:49.297696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E78799A0>]}
[0m15:45:49.299696 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:45:49.671906 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:45:49.832986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:49.832986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:49.863525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E9437CB0>]}
[0m15:45:49.924605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:45:49.927129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:45:49.946504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E9643F50>]}
[0m15:45:49.946504 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m15:45:49.946504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E9627BF0>]}
[0m15:45:49.946504 [info ] [MainThread]: 
[0m15:45:49.946504 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:45:49.946504 [info ] [MainThread]: 
[0m15:45:49.962528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:49.965522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m15:45:50.082126 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m15:45:50.082126 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m15:45:50.083124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:52.098125 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.015 seconds
[0m15:45:52.101045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a329126-c436-4009-a243-81b12e4b7612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E90AF560>]}
[0m15:45:52.106037 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:45:52.107038 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m15:45:52.108039 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m15:45:52.108039 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:45:52.107038 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m15:45:52.109038 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:45:52.110039 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m15:45:52.110039 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:45:52.107038 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m15:45:52.111037 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:45:52.111037 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:45:52.112038 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:45:52.109038 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m15:45:52.113039 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:45:52.113039 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m15:45:52.109038 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m15:45:52.111037 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m15:45:52.120647 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m15:45:52.129438 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:45:52.112038 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m15:45:52.132114 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m15:45:52.133122 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m15:45:52.114038 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m15:45:52.133122 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m15:45:52.134206 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m15:45:52.114038 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m15:45:52.135239 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m15:45:52.137219 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m15:45:52.130609 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m15:45:52.138219 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:45:52.138219 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m15:45:52.139220 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:45:52.139220 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:45:52.142225 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m15:45:52.142225 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m15:45:52.143219 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:45:52.143772 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m15:45:52.151412 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:45:52.152418 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:45:52.172341 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:45:52.174347 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:45:52.175350 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:45:52.181260 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:45:52.182257 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:45:52.245757 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:45:52.245757 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m15:45:52.245757 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m15:45:52.245757 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:45:52.245757 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m15:45:52.245757 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:45:52.245757 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:45:52.245757 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:45:52.245757 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:45:52.245757 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m15:45:52.261706 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m15:45:52.262709 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:45:52.262709 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m15:45:52.264705 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:45:52.264705 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:45:52.266705 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:45:52.267866 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:45:52.269868 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:45:52.269868 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:45:52.271980 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m15:45:52.271980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:52.272974 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m15:45:52.274974 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:45:52.274974 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m15:45:52.277976 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:45:52.277976 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m15:45:52.279080 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m15:45:52.279080 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m15:45:52.279975 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m15:45:52.279975 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m15:45:52.281981 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:45:52.283412 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m15:45:52.283412 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:52.284422 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m15:45:52.284422 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:45:52.285495 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m15:45:52.289968 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:45:52.285495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:45:52.286512 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:45:52.286512 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m15:45:52.287543 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:45:52.288507 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:45:52.286512 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m15:45:52.294412 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m15:45:52.297657 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:45:52.297657 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:54.712073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9fd47-3201-65a7-000b-94b60001c232
[0m15:45:54.713074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m15:45:54.716074 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:45:54.716074 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.61s]
[0m15:45:54.717735 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m15:45:54.718750 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m15:45:54.727883 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m15:45:54.735428 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.60s]
[0m15:45:54.736367 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m15:45:54.804250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.521 seconds
[0m15:45:54.806250 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 2.69s]
[0m15:45:54.807249 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m15:45:54.819033 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.530 seconds
[0m15:45:54.821278 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.68s]
[0m15:45:54.822282 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m15:45:54.833095 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.536 seconds
[0m15:45:54.834101 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.69s]
[0m15:45:54.835144 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m15:45:54.840440 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.542 seconds
[0m15:45:54.841440 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.71s]
[0m15:45:54.843667 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m15:45:54.991497 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.697 seconds
[0m15:45:54.993948 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.85s]
[0m15:45:54.994950 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m15:45:55.011122 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.725 seconds
[0m15:45:55.012139 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.89s]
[0m15:45:55.014122 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m15:45:55.131703 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.845 seconds
[0m15:45:55.133247 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 3.00s]
[0m15:45:55.134263 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m15:45:55.138479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:55.138479 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m15:45:55.138479 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m15:45:55.795258 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m15:45:55.796259 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m15:45:56.446314 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m15:45:56.446314 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m15:45:57.112617 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m15:45:57.112617 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m15:45:58.140976 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m15:45:58.141976 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m15:45:58.799705 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m15:45:58.799705 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m15:45:59.459000 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m15:45:59.459000 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m15:46:00.115195 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m15:46:00.115195 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m15:46:00.770951 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m15:46:00.770951 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m15:46:01.430626 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m15:46:01.431600 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m15:46:02.102856 [info ] [MainThread]: 
[0m15:46:02.103859 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 12.14 seconds (12.14s).
[0m15:46:02.104865 [debug] [MainThread]: Command end result
[0m15:46:02.125118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m15:46:02.128487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m15:46:02.134515 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m15:46:02.135907 [info ] [MainThread]: 
[0m15:46:02.135907 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:46:02.136950 [info ] [MainThread]: 
[0m15:46:02.137964 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m15:46:02.139199 [info ] [MainThread]: 
[0m15:46:02.139199 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m15:46:02.139199 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m15:46:02.140744 [info ] [MainThread]: 
[0m15:46:02.140744 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m15:46:02.142424 [info ] [MainThread]: 
[0m15:46:02.142424 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m15:46:02.143530 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m15:46:02.144541 [info ] [MainThread]: 
[0m15:46:02.144541 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m15:46:02.146057 [info ] [MainThread]: 
[0m15:46:02.147072 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m15:46:02.148025 [debug] [MainThread]: Command `dbt test` failed at 15:46:02.148025 after 13.44 seconds
[0m15:46:02.149038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E4731E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E4733110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E7DD8BC0>]}
[0m15:46:02.149038 [debug] [MainThread]: Flushing usage events
[0m15:46:03.246362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:46.901252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB970BF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB970BEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB970BFB90>]}


============================== 18:17:46.909250 | c396db9a-dab8-49d0-84b7-190eefa9ed5d ==============================
[0m18:17:46.909250 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:17:46.910248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:47.625556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB98606180>]}
[0m18:17:47.676086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99714AA0>]}
[0m18:17:47.678089 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:17:48.068339 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:17:48.348413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:48.348413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:48.380214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99730EF0>]}
[0m18:17:48.451776 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:17:48.456778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:17:48.524299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99CD5910>]}
[0m18:17:48.525295 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m18:17:48.525295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99C5D100>]}
[0m18:17:48.529294 [info ] [MainThread]: 
[0m18:17:48.529294 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:17:48.530300 [info ] [MainThread]: 
[0m18:17:48.531295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:48.537295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:17:48.852053 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:17:48.852053 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:17:48.852053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:52.592961 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.741 seconds
[0m18:17:52.595962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c396db9a-dab8-49d0-84b7-190eefa9ed5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9970C620>]}
[0m18:17:52.599961 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:17:52.600961 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m18:17:52.600961 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m18:17:52.601961 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:17:52.600961 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m18:17:52.602967 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:17:52.601961 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m18:17:52.602967 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:17:52.603964 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:17:52.602967 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m18:17:52.604962 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:17:52.605966 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:17:52.606962 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m18:17:52.605966 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m18:17:52.608961 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m18:17:52.607961 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m18:17:52.608961 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m18:17:52.609961 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m18:17:52.609961 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m18:17:52.611962 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:17:52.612958 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m18:17:52.610966 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m18:17:52.612958 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m18:17:52.613958 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m18:17:52.610966 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m18:17:52.613958 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m18:17:52.613958 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m18:17:52.614961 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m18:17:52.628405 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:17:52.629406 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:17:52.630406 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m18:17:52.633405 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m18:17:52.634407 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:17:52.634407 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m18:17:52.635403 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:17:52.636406 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m18:17:52.637406 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:17:52.644407 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:17:52.645406 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:17:52.652417 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:17:52.652417 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:17:52.713933 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:17:52.716934 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:17:52.721939 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:17:52.722935 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m18:17:52.728932 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:17:52.733933 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:17:52.746934 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:17:52.747934 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m18:17:52.749931 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m18:17:52.749931 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:17:52.750940 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:17:52.752936 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m18:17:52.754936 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:17:52.757040 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:17:52.757040 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:17:52.758043 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:17:52.759036 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:17:52.760037 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m18:17:52.760037 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:17:52.762035 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:17:52.762035 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:17:52.763035 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:17:52.765035 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:17:52.765542 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m18:17:52.767552 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:17:52.767552 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:17:52.768551 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m18:17:52.768551 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m18:17:52.769554 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:17:52.770552 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m18:17:52.770552 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m18:17:52.771549 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:17:52.772549 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:17:52.772549 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:17:52.773548 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:52.773548 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:17:52.774548 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:17:52.774548 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:17:52.774548 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:17:52.775547 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:17:52.775547 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:52.777552 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:17:52.780557 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m18:17:52.782548 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:17:52.784548 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m18:17:52.785549 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:17:52.785549 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:17:52.786550 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:17:52.788549 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:17:55.274124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba0ebf-3201-679a-000b-94b600028006
[0m18:17:55.274124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m18:17:55.278136 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:17:55.278136 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.67s]
[0m18:17:55.279129 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:17:55.280124 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m18:17:55.787088 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.013 seconds
[0m18:17:55.795084 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 3.18s]
[0m18:17:55.796085 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:17:55.815088 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 3.030 seconds
[0m18:17:55.817094 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 3.20s]
[0m18:17:55.818090 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:17:55.823404 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.051 seconds
[0m18:17:55.825395 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 3.22s]
[0m18:17:55.826395 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m18:17:56.127925 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 3.339 seconds
[0m18:17:56.128924 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 3.50s]
[0m18:17:56.129922 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:17:56.255630 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 3.469 seconds
[0m18:17:56.257628 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 3.64s]
[0m18:17:56.258626 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:17:56.271624 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.497 seconds
[0m18:17:56.273867 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 3.66s]
[0m18:17:56.273867 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m18:17:56.323242 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 3.548 seconds
[0m18:17:56.324234 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 3.71s]
[0m18:17:56.325234 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:17:56.413645 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 3.629 seconds
[0m18:17:56.415645 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 3.78s]
[0m18:17:56.415645 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:17:56.417652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:56.419134 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:17:56.419134 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:17:57.075224 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m18:17:57.075224 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m18:17:57.747217 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m18:17:57.747217 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m18:17:58.418157 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m18:17:58.419157 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m18:17:59.088052 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m18:17:59.089051 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m18:17:59.764861 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m18:17:59.764861 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m18:18:00.438518 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m18:18:00.439517 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m18:18:01.095591 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m18:18:01.095591 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m18:18:01.756228 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m18:18:01.757228 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m18:18:02.434587 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m18:18:02.435599 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m18:18:03.106459 [info ] [MainThread]: 
[0m18:18:03.107457 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 14.58 seconds (14.58s).
[0m18:18:03.110457 [debug] [MainThread]: Command end result
[0m18:18:03.152020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:18:03.160038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:18:03.171773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:18:03.172773 [info ] [MainThread]: 
[0m18:18:03.173772 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:18:03.173772 [info ] [MainThread]: 
[0m18:18:03.175278 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:18:03.176285 [info ] [MainThread]: 
[0m18:18:03.177286 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m18:18:03.178286 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m18:18:03.178286 [info ] [MainThread]: 
[0m18:18:03.179286 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m18:18:03.180288 [info ] [MainThread]: 
[0m18:18:03.181288 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m18:18:03.182289 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m18:18:03.182289 [info ] [MainThread]: 
[0m18:18:03.183287 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m18:18:03.184289 [info ] [MainThread]: 
[0m18:18:03.185291 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:18:03.188287 [debug] [MainThread]: Command `dbt test` failed at 18:18:03.187286 after 16.49 seconds
[0m18:18:03.188287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB97C0B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB97AA7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB97AA7890>]}
[0m18:18:03.189285 [debug] [MainThread]: Flushing usage events
[0m18:18:04.275122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:31.368489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E669882FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E669880EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E669880F50>]}


============================== 18:18:31.375488 | 5c3a9550-23f5-43bb-99bb-3394acf8a78c ==============================
[0m18:18:31.375488 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:18:31.376489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:18:31.840354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66AC5F380>]}
[0m18:18:31.886370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66A946AB0>]}
[0m18:18:31.887369 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:18:32.303173 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:18:32.507766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:32.507766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:32.539769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66BE5B590>]}
[0m18:18:32.606284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:18:32.610289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:18:32.655284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66C3F6180>]}
[0m18:18:32.656285 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m18:18:32.656285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66C3A7FB0>]}
[0m18:18:32.657286 [info ] [MainThread]: 
[0m18:18:32.658287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:18:32.658287 [info ] [MainThread]: 
[0m18:18:32.658287 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:18:32.662284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:18:32.792743 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:18:32.793744 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:18:32.793744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:34.744483 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.950 seconds
[0m18:18:34.747483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3a9550-23f5-43bb-99bb-3394acf8a78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66BE30FB0>]}
[0m18:18:34.755483 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:18:34.756483 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m18:18:34.757486 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m18:18:34.757486 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:18:34.758483 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:18:34.758483 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m18:18:34.759482 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:18:34.759482 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:18:34.760483 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:18:34.759482 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m18:18:34.760483 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:18:34.761482 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m18:18:34.762482 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m18:18:34.761482 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m18:18:34.762482 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m18:18:34.763482 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m18:18:34.764482 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m18:18:34.763482 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m18:18:34.765482 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m18:18:34.763482 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m18:18:34.766484 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:18:34.767483 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m18:18:34.765482 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m18:18:34.767483 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m18:18:34.768484 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m18:18:34.769484 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m18:18:34.770486 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m18:18:34.771484 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m18:18:34.771484 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m18:18:34.784484 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:18:34.785484 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:18:34.785484 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m18:18:34.786483 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:18:34.786483 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:18:34.790490 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m18:18:34.790490 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:18:34.792487 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m18:18:34.823006 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:18:34.803002 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:18:34.804002 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:18:34.813002 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:18:34.817000 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:18:34.822002 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:18:34.793488 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:18:34.899034 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:18:34.905547 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:18:34.905547 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m18:18:34.910545 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:18:34.910545 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:18:34.911544 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m18:18:34.913544 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m18:18:34.914544 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:18:34.916545 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:18:34.916545 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:18:34.917544 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:18:34.918545 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m18:18:34.919545 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:18:34.920545 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:18:34.922544 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:18:34.923544 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:18:34.925545 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:18:34.927546 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:18:34.929545 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:18:34.930546 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m18:18:34.931545 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:18:34.931545 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m18:18:34.934551 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:18:34.935544 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m18:18:34.936545 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m18:18:34.937544 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:18:34.937544 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m18:18:34.938554 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:18:34.938554 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:34.939545 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:18:34.940544 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:18:34.940544 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:18:34.941544 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:18:34.941544 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m18:18:34.941544 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m18:18:34.941544 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:34.942545 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:18:34.943544 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:34.946550 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:18:34.947553 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:18:34.948544 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:18:34.949545 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:18:34.949545 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:18:34.950545 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m18:18:34.950545 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:18:34.953546 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:18:37.505531 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.557 seconds
[0m18:18:37.512533 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.74s]
[0m18:18:37.513531 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:18:37.571740 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.621 seconds
[0m18:18:37.572741 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.79s]
[0m18:18:37.573740 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:18:37.591405 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.638 seconds
[0m18:18:37.593405 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.82s]
[0m18:18:37.595405 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.655 seconds
[0m18:18:37.595405 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:18:37.596404 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.656 seconds
[0m18:18:37.598404 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 2.83s]
[0m18:18:37.601404 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.652 seconds
[0m18:18:37.600404 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.83s]
[0m18:18:37.602406 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m18:18:37.604912 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 2.84s]
[0m18:18:37.605912 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:18:37.606912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.659 seconds
[0m18:18:37.608912 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:18:37.610914 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.85s]
[0m18:18:37.612914 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m18:18:37.627914 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba0ec0-3201-666e-000b-94b600022146
[0m18:18:37.629914 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m18:18:37.631912 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.681 seconds
[0m18:18:37.633913 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.86s]
[0m18:18:37.634912 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:18:37.640917 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:18:37.641916 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.88s]
[0m18:18:37.642917 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:18:37.643917 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m18:18:37.646917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:37.647918 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:18:37.647918 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:18:38.347807 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m18:18:38.347807 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m18:18:39.059202 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m18:18:39.059202 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m18:18:39.753288 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m18:18:39.753288 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m18:18:40.437240 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m18:18:40.438246 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m18:18:41.092574 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m18:18:41.093574 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m18:18:41.760880 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m18:18:41.760880 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m18:18:42.420147 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m18:18:42.420147 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m18:18:43.073269 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m18:18:43.073269 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m18:18:43.760984 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m18:18:43.760984 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m18:18:44.418647 [info ] [MainThread]: 
[0m18:18:44.419646 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 11.76 seconds (11.76s).
[0m18:18:44.421646 [debug] [MainThread]: Command end result
[0m18:18:44.440646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:18:44.442646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:18:44.447646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:18:44.447646 [info ] [MainThread]: 
[0m18:18:44.448646 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:18:44.448646 [info ] [MainThread]: 
[0m18:18:44.449649 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m18:18:44.450650 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m18:18:44.451649 [info ] [MainThread]: 
[0m18:18:44.452648 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m18:18:44.453649 [info ] [MainThread]: 
[0m18:18:44.454649 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m18:18:44.454649 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m18:18:44.455648 [info ] [MainThread]: 
[0m18:18:44.455648 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m18:18:44.456647 [info ] [MainThread]: 
[0m18:18:44.457649 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:18:44.458649 [info ] [MainThread]: 
[0m18:18:44.459650 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:18:44.460648 [debug] [MainThread]: Command `dbt test` failed at 18:18:44.460648 after 13.29 seconds
[0m18:18:44.460648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E66A201400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E669E8A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E669E8A5A0>]}
[0m18:18:44.461647 [debug] [MainThread]: Flushing usage events
[0m18:18:45.941681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:14.348550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBBC81700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBBC81730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBBC81790>]}


============================== 18:22:14.355554 | 243ba84c-8b66-442e-9949-122dfa5d0776 ==============================
[0m18:22:14.355554 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:22:14.356549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:22:14.724594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBE4EE360>]}
[0m18:22:14.764590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBF981E80>]}
[0m18:22:14.765591 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:22:15.128411 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:22:15.312929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:15.313928 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\fct_order.sql
[0m18:22:15.643520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBFF5D760>]}
[0m18:22:15.706515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:22:15.711520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:22:15.804027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBFE72060>]}
[0m18:22:15.804027 [info ] [MainThread]: Found 5 models, 9 data tests, 2 sources, 587 macros
[0m18:22:15.805027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBFEC2C30>]}
[0m18:22:15.806027 [info ] [MainThread]: 
[0m18:22:15.807027 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:22:15.807027 [info ] [MainThread]: 
[0m18:22:15.808030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:22:15.812029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:22:15.933030 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:22:15.933030 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:22:15.934031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:17.908802 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.975 seconds
[0m18:22:17.911810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243ba84c-8b66-442e-9949-122dfa5d0776', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC002BE60>]}
[0m18:22:17.917807 [debug] [Thread-1 (]: Began running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:22:17.917807 [debug] [Thread-2 (]: Began running node test.data_pipeline.fct_orders_date_valid
[0m18:22:17.918802 [debug] [Thread-3 (]: Began running node test.data_pipeline.fct_orders_discount
[0m18:22:17.918802 [debug] [Thread-4 (]: Began running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:22:17.917807 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_fct_order_status_code__P__O__F ............... [RUN]
[0m18:22:17.919803 [debug] [Thread-5 (]: Began running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:22:17.920804 [debug] [Thread-6 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:22:17.920804 [debug] [Thread-7 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:22:17.919803 [info ] [Thread-2 (]: 2 of 9 START test fct_orders_date_valid ........................................ [RUN]
[0m18:22:17.920804 [debug] [Thread-8 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:22:17.920804 [debug] [Thread-9 (]: Began running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:22:17.921803 [info ] [Thread-3 (]: 3 of 9 START test fct_orders_discount .......................................... [RUN]
[0m18:22:17.921803 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af'
[0m18:22:17.921803 [info ] [Thread-4 (]: 4 of 9 START test not_null_fct_order_order_key ................................. [RUN]
[0m18:22:17.923310 [info ] [Thread-5 (]: 5 of 9 START test relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_  [RUN]
[0m18:22:17.925326 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_date_valid'
[0m18:22:17.923310 [info ] [Thread-6 (]: 6 of 9 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m18:22:17.926319 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m18:22:17.924327 [info ] [Thread-7 (]: 7 of 9 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m18:22:17.927320 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:22:17.928324 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325'
[0m18:22:17.925326 [info ] [Thread-8 (]: 8 of 9 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m18:22:17.928324 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96'
[0m18:22:17.928324 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.fct_orders_date_valid
[0m18:22:17.926319 [info ] [Thread-9 (]: 9 of 9 START test unique_fct_order_order_key ................................... [RUN]
[0m18:22:17.929322 [debug] [Thread-6 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m18:22:17.930322 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m18:22:17.930322 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m18:22:17.936322 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:22:17.937322 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:22:17.938328 [debug] [Thread-8 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m18:22:17.938328 [debug] [Thread-5 (]: Began compiling node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:22:17.941325 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_date_valid"
[0m18:22:17.941325 [debug] [Thread-9 (]: Acquiring new snowflake connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671'
[0m18:22:17.942322 [debug] [Thread-6 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:22:17.945325 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m18:22:17.946318 [debug] [Thread-7 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:22:17.953323 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:22:17.954319 [debug] [Thread-8 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:22:17.960418 [debug] [Thread-5 (]: Writing injected SQL for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:22:17.961409 [debug] [Thread-9 (]: Began compiling node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:22:17.961409 [debug] [Thread-1 (]: Began executing node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:22:17.967413 [debug] [Thread-6 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:22:17.971947 [debug] [Thread-7 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:22:17.972947 [debug] [Thread-2 (]: Began executing node test.data_pipeline.fct_orders_date_valid
[0m18:22:17.978642 [debug] [Thread-8 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:22:17.982635 [debug] [Thread-9 (]: Writing injected SQL for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:22:17.997281 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:22:17.998287 [debug] [Thread-3 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m18:22:18.000276 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_date_valid"
[0m18:22:18.001286 [debug] [Thread-5 (]: Began executing node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:22:18.001286 [debug] [Thread-4 (]: Began executing node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:22:18.002276 [debug] [Thread-7 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:22:18.002276 [debug] [Thread-6 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:22:18.005345 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m18:22:18.008480 [debug] [Thread-5 (]: Writing runtime sql for node "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:22:18.008480 [debug] [Thread-8 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:22:18.013493 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:22:18.014497 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"
[0m18:22:18.017492 [debug] [Thread-7 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:22:18.018492 [debug] [Thread-9 (]: Began executing node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:22:18.020499 [debug] [Thread-6 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:22:18.021497 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.fct_orders_date_valid"
[0m18:22:18.024987 [debug] [Thread-8 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:22:18.024987 [debug] [Thread-1 (]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status_code as value_field,
        count(*) as n_records

    from dbt_db.dbt_schema.fct_order
    group by status_code

)

select *
from all_values
where value_field not in (
    'P','O','F'
)



      
    ) dbt_internal_test
[0m18:22:18.025992 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m18:22:18.027993 [debug] [Thread-5 (]: Using snowflake connection "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"
[0m18:22:18.027993 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.not_null_fct_order_order_key.44ce857325"
[0m18:22:18.030989 [debug] [Thread-9 (]: Writing runtime sql for node "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:22:18.031991 [debug] [Thread-7 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:22:18.032986 [debug] [Thread-2 (]: On test.data_pipeline.fct_orders_date_valid: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_date_valid"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    date(order_date) > CURRENT_DATE()
    or date(order_date) < date('1990-01-01')
      
    ) dbt_internal_test
[0m18:22:18.033987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:18.033987 [debug] [Thread-3 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m18:22:18.034985 [debug] [Thread-5 (]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_key as from_field
    from dbt_db.dbt_schema.fct_order
    where order_key is not null
),

parent as (
    select order_key as to_field
    from dbt_db.dbt_schema.stg_tpch_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:22:18.034985 [debug] [Thread-6 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:22:18.035989 [debug] [Thread-8 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:22:18.035989 [debug] [Thread-4 (]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.not_null_fct_order_order_key.44ce857325"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from dbt_db.dbt_schema.fct_order
where order_key is null



      
    ) dbt_internal_test
[0m18:22:18.036987 [debug] [Thread-7 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:22:18.036987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:22:18.037988 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:22:18.037988 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:22:18.039987 [debug] [Thread-6 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m18:22:18.040985 [debug] [Thread-9 (]: Using snowflake connection "test.data_pipeline.unique_fct_order_order_key.a653ae6671"
[0m18:22:18.041993 [debug] [Thread-8 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:22:18.041993 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:22:18.042993 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:22:18.045986 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:22:18.047995 [debug] [Thread-9 (]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.unique_fct_order_order_key.a653ae6671"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from dbt_db.dbt_schema.fct_order
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m18:22:18.048989 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:22:18.054174 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m18:22:20.501409 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.459 seconds
[0m18:22:20.507410 [info ] [Thread-4 (]: 4 of 9 PASS not_null_fct_order_order_key ....................................... [[32mPASS[0m in 2.58s]
[0m18:22:20.508407 [debug] [Thread-4 (]: Finished running node test.data_pipeline.not_null_fct_order_order_key.44ce857325
[0m18:22:20.545472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba0ec4-3201-666e-000b-94b60002214e
[0m18:22:20.545472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'STATUS_CODE'
[0m18:22:20.552471 [debug] [Thread-1 (]: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:22:20.553984 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_fct_order_status_code__P__O__F .................... [[31mERROR[0m in 2.63s]
[0m18:22:20.555997 [debug] [Thread-1 (]: Finished running node test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af
[0m18:22:20.556997 [debug] [Thread-13 ]: Marking all children of 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql.
[0m18:22:20.574106 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.536 seconds
[0m18:22:20.577126 [error] [Thread-3 (]: 3 of 9 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.65s]
[0m18:22:20.578115 [debug] [Thread-3 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m18:22:20.631779 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.594 seconds
[0m18:22:20.632777 [info ] [Thread-2 (]: 2 of 9 PASS fct_orders_date_valid .............................................. [[32mPASS[0m in 2.71s]
[0m18:22:20.633771 [debug] [Thread-2 (]: Finished running node test.data_pipeline.fct_orders_date_valid
[0m18:22:20.643305 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 2.589 seconds
[0m18:22:20.646302 [error] [Thread-9 (]: 9 of 9 FAIL 1285828 unique_fct_order_order_key ................................. [[31mFAIL 1285828[0m in 2.70s]
[0m18:22:20.647304 [debug] [Thread-9 (]: Finished running node test.data_pipeline.unique_fct_order_order_key.a653ae6671
[0m18:22:20.659833 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 2.613 seconds
[0m18:22:20.661831 [info ] [Thread-6 (]: 6 of 9 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.73s]
[0m18:22:20.662832 [debug] [Thread-6 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:22:20.670835 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 2.628 seconds
[0m18:22:20.673069 [info ] [Thread-7 (]: 7 of 9 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.74s]
[0m18:22:20.673931 [debug] [Thread-7 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:22:20.685941 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.636 seconds
[0m18:22:20.687451 [info ] [Thread-8 (]: 8 of 9 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.75s]
[0m18:22:20.687451 [debug] [Thread-8 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:22:20.722105 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.684 seconds
[0m18:22:20.724096 [info ] [Thread-5 (]: 5 of 9 PASS relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_ . [[32mPASS[0m in 2.79s]
[0m18:22:20.724096 [debug] [Thread-5 (]: Finished running node test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96
[0m18:22:20.726097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:20.727336 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:22:20.727336 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:22:21.418967 [debug] [MainThread]: Connection 'test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af' was left open.
[0m18:22:21.418967 [debug] [MainThread]: On test.data_pipeline.accepted_values_fct_order_status_code__P__O__F.1b38b2f4af: Close
[0m18:22:22.082703 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_date_valid' was left open.
[0m18:22:22.082703 [debug] [MainThread]: On test.data_pipeline.fct_orders_date_valid: Close
[0m18:22:22.773433 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m18:22:22.774441 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m18:22:23.439487 [debug] [MainThread]: Connection 'test.data_pipeline.not_null_fct_order_order_key.44ce857325' was left open.
[0m18:22:23.440483 [debug] [MainThread]: On test.data_pipeline.not_null_fct_order_order_key.44ce857325: Close
[0m18:22:24.120693 [debug] [MainThread]: Connection 'test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96' was left open.
[0m18:22:24.121693 [debug] [MainThread]: On test.data_pipeline.relationships_fct_order_order_key__order_key__ref_stg_tpch_orders_.37535f7a96: Close
[0m18:22:24.775422 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m18:22:24.775422 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m18:22:25.442925 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m18:22:25.442925 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m18:22:26.101774 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m18:22:26.101774 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m18:22:26.772019 [debug] [MainThread]: Connection 'test.data_pipeline.unique_fct_order_order_key.a653ae6671' was left open.
[0m18:22:26.772019 [debug] [MainThread]: On test.data_pipeline.unique_fct_order_order_key.a653ae6671: Close
[0m18:22:27.440253 [info ] [MainThread]: 
[0m18:22:27.441252 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m18:22:27.443255 [debug] [MainThread]: Command end result
[0m18:22:27.462444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:22:27.464445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:22:27.470957 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:22:27.470957 [info ] [MainThread]: 
[0m18:22:27.471963 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:22:27.471963 [info ] [MainThread]: 
[0m18:22:27.472961 [error] [MainThread]:   Database Error in test accepted_values_fct_order_status_code__P__O__F (models\marts\generic_tests.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\generic_tests.yml\accepted_values_fct_order_status_code__P__O__F.sql
[0m18:22:27.473961 [info ] [MainThread]: 
[0m18:22:27.474962 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m18:22:27.474962 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m18:22:27.475963 [info ] [MainThread]: 
[0m18:22:27.475963 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m18:22:27.476964 [info ] [MainThread]: 
[0m18:22:27.476964 [error] [MainThread]: [31mFailure in test unique_fct_order_order_key (models\marts\generic_tests.yml)[0m
[0m18:22:27.477962 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m18:22:27.477962 [info ] [MainThread]: 
[0m18:22:27.478962 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\models\marts\generic_tests.yml\unique_fct_order_order_key.sql
[0m18:22:27.478962 [info ] [MainThread]: 
[0m18:22:27.479963 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:22:27.481961 [debug] [MainThread]: Command `dbt test` failed at 18:22:27.480963 after 13.33 seconds
[0m18:22:27.481961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBDE927B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBD9F2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBD9F1BB0>]}
[0m18:22:27.481961 [debug] [MainThread]: Flushing usage events
[0m18:22:29.156347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:26.660221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDD490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDD010>]}


============================== 18:28:26.667217 | 99711838-3f53-4164-be00-674107f71a1c ==============================
[0m18:28:26.667217 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:28:26.668216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:27.094996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014889397560>]}
[0m18:28:27.143132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888B0B920>]}
[0m18:28:27.145133 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:28:27.524383 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:28:27.702431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:28:27.703445 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m18:28:27.703445 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_date_valid.sql
[0m18:28:27.945431 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\generic_tests.yml'
[0m18:28:28.020541 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.fct_orders_date_valid' (tests\fct_orders_date_valid.sql) depends on a node named 'fct_orders' in package '' which was not found
[0m18:28:28.021553 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:28:28.022552 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:28:28.023551 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:28:28.023551 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.accepted_values_fct_orders_status_code__P__O__F.2c062f3048' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:28:28.075298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488AE55310>]}
[0m18:28:28.198787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:28:28.201787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:28:28.229788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488AD50680>]}
[0m18:28:28.229788 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 587 macros
[0m18:28:28.230788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488AE54680>]}
[0m18:28:28.231789 [info ] [MainThread]: 
[0m18:28:28.232787 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:28:28.233787 [info ] [MainThread]: 
[0m18:28:28.234790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:28.237787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:28:28.433245 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:28:28.433245 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m18:28:28.433245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:30.416981 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.983 seconds
[0m18:28:30.418981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:28:30.426981 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:28:30.427982 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:28:30.427982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:32.249360 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.821 seconds
[0m18:28:32.251357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488ADF7F20>]}
[0m18:28:32.255506 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m18:28:32.256502 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m18:28:32.256502 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m18:28:32.260502 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m18:28:32.260502 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m18:28:32.261973 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m18:28:32.261973 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m18:28:32.276501 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m18:28:32.276501 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m18:28:32.279503 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m18:28:32.282500 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m18:28:32.282500 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m18:28:32.308169 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m18:28:32.310160 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m18:28:32.313940 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m18:28:32.314948 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m18:28:32.315949 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m18:28:32.315949 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m18:28:32.316954 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:28:32.316954 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:34.510075 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.194 seconds
[0m18:28:34.527070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148860B4CB0>]}
[0m18:28:34.527070 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.26s]
[0m18:28:34.528074 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m18:28:34.549184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.233 seconds
[0m18:28:34.551187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488B30FF50>]}
[0m18:28:34.551187 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.29s]
[0m18:28:34.552188 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m18:28:34.553186 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m18:28:34.553186 [debug] [Thread-5 (]: Began running node model.data_pipeline.int_order_items_summary
[0m18:28:34.553186 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m18:28:34.555185 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m18:28:34.556187 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m18:28:34.554185 [info ] [Thread-5 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m18:28:34.560187 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m18:28:34.560187 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m18:28:34.561194 [debug] [Thread-5 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m18:28:34.564072 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m18:28:34.565067 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m18:28:34.566067 [debug] [Thread-5 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m18:28:34.582382 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m18:28:34.586381 [debug] [Thread-5 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m18:28:34.588897 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m18:28:34.588897 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m18:28:34.589896 [debug] [Thread-5 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m18:28:34.589896 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:28:34.589896 [debug] [Thread-5 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    order_item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_percentage * extended_price) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    order_item_key,
    order_key
        );
[0m18:28:34.590895 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:28:44.915550 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 10.324 seconds
[0m18:28:44.916559 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488B2C3B00>]}
[0m18:28:44.917553 [info ] [Thread-5 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 10.36s]
[0m18:28:44.918553 [debug] [Thread-5 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m18:28:44.918553 [debug] [Thread-7 (]: Began running node model.data_pipeline.fct_order
[0m18:28:44.918553 [info ] [Thread-7 (]: 5 of 5 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m18:28:44.920550 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m18:28:44.920550 [debug] [Thread-7 (]: Began compiling node model.data_pipeline.fct_order
[0m18:28:44.923549 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m18:28:44.925554 [debug] [Thread-7 (]: Began executing node model.data_pipeline.fct_order
[0m18:28:44.927553 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m18:28:44.929557 [debug] [Thread-7 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m18:28:44.930551 [debug] [Thread-7 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (-- select
--     orders.*,
--     order_item_summary.gross_item_sales_amount,
--     order_item_summary.item_discount_amount
-- from 
--     dbt_db.dbt_schema.stg_tpch_orders as orders 
-- join 
--     dbt_db.dbt_schema.int_order_items_summary as order_item_summary
-- on orders.order_key = order_item_summary.order_key
-- order by 
--     order_date


select
    orders.*,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount,
    orders.status_code  -- Ensure this column exists
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m18:28:44.930551 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:28:46.808416 [debug] [Thread-7 (]: Snowflake adapter: Snowflake query id: 01ba0eca-3201-677b-000b-94b600027046
[0m18:28:46.808416 [debug] [Thread-7 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'ORDERS.STATUS_CODE'
[0m18:28:46.811410 [debug] [Thread-7 (]: Database Error in model fct_order (models\marts\fct_order.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'ORDERS.STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql
[0m18:28:46.812410 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488B400A40>]}
[0m18:28:46.812410 [error] [Thread-7 (]: 5 of 5 ERROR creating sql table model dbt_schema.fct_order ..................... [[31mERROR[0m in 1.89s]
[0m18:28:46.813411 [debug] [Thread-7 (]: Finished running node model.data_pipeline.fct_order
[0m18:28:46.814413 [debug] [Thread-13 ]: Marking all children of 'model.data_pipeline.fct_order' to be skipped because of status 'error'.  Reason: Database Error in model fct_order (models\marts\fct_order.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'ORDERS.STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql.
[0m18:28:47.877819 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 13.287 seconds
[0m18:28:47.878818 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99711838-3f53-4164-be00-674107f71a1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001488B2C3980>]}
[0m18:28:47.879818 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 13.32s]
[0m18:28:47.880819 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m18:28:47.883820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:47.883820 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:28:47.883820 [debug] [MainThread]: On list_dbt_db: Close
[0m18:28:48.551641 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:28:48.551641 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:28:49.207300 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m18:28:49.208299 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m18:28:49.862538 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m18:28:49.862538 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m18:28:50.517003 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m18:28:50.517003 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m18:28:51.187309 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m18:28:51.188309 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m18:28:51.846071 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m18:28:51.846071 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m18:28:52.502316 [info ] [MainThread]: 
[0m18:28:52.503319 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 24.27 seconds (24.27s).
[0m18:28:52.505608 [debug] [MainThread]: Command end result
[0m18:28:52.523618 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:28:52.525618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:28:52.530618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:28:52.530618 [info ] [MainThread]: 
[0m18:28:52.531615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:28:52.531615 [info ] [MainThread]: 
[0m18:28:52.532617 [error] [MainThread]:   Database Error in model fct_order (models\marts\fct_order.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'ORDERS.STATUS_CODE'
  compiled code at target\run\data_pipeline\models\marts\fct_order.sql
[0m18:28:52.533615 [info ] [MainThread]: 
[0m18:28:52.533615 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:28:52.534614 [debug] [MainThread]: Command `dbt run` failed at 18:28:52.534614 after 26.09 seconds
[0m18:28:52.534614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDD490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDDA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014888CDD010>]}
[0m18:28:52.535624 [debug] [MainThread]: Flushing usage events
[0m18:28:54.020087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:11.304766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56982DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56982D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56982C620>]}


============================== 18:34:11.309766 | 45008d59-cd85-4f24-a763-a56b1ba87d4d ==============================
[0m18:34:11.309766 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:34:11.309766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:34:11.675747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56982E0F0>]}
[0m18:34:11.719265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56920F080>]}
[0m18:34:11.720272 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:34:12.088904 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:34:12.268813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:34:12.269817 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\generic_tests.yml
[0m18:34:12.269817 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://models\marts\fct_order.sql
[0m18:34:12.439168 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\generic_tests.yml'
[0m18:34:12.526621 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.unique_fct_orders_order_key.f5e7a90273' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:34:12.527621 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.not_null_fct_orders_order_key.6a6f83ab15' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:34:12.528618 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.relationships_fct_orders_order_key__order_key__ref_stg_tpch_orders_.05b89e79ce' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:34:12.528618 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.data_pipeline.accepted_values_fct_orders_order_status__P__O__F.df1a317f07' (models\marts\generic_tests.yml) depends on a node named 'fct_orders' in package '' which was not found
[0m18:34:12.589911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56B919FD0>]}
[0m18:34:12.653435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:34:12.657438 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:34:12.748019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56B918500>]}
[0m18:34:12.748019 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 587 macros
[0m18:34:12.749017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56BA2EEA0>]}
[0m18:34:12.750025 [info ] [MainThread]: 
[0m18:34:12.751024 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:34:12.752039 [info ] [MainThread]: 
[0m18:34:12.752039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:12.756021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db'
[0m18:34:12.877537 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db"
[0m18:34:12.877537 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db"} */
show terse schemas in database dbt_db
    limit 10000
[0m18:34:12.877537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:14.805211 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.927 seconds
[0m18:34:14.808212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:34:14.815213 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:34:14.815213 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:34:14.815213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:16.712700 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.897 seconds
[0m18:34:16.715700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A568D0FEF0>]}
[0m18:34:16.719699 [debug] [Thread-1 (]: Began running node model.data_pipeline.stg_tpch_line_items
[0m18:34:16.719699 [debug] [Thread-2 (]: Began running node model.data_pipeline.stg_tpch_orders
[0m18:34:16.719699 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.stg_tpch_line_items ..................... [RUN]
[0m18:34:16.720695 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_line_items'
[0m18:34:16.720695 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_schema.stg_tpch_orders ......................... [RUN]
[0m18:34:16.721705 [debug] [Thread-1 (]: Began compiling node model.data_pipeline.stg_tpch_line_items
[0m18:34:16.721705 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.data_pipeline.stg_tpch_orders'
[0m18:34:16.737616 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_line_items"
[0m18:34:16.738615 [debug] [Thread-2 (]: Began compiling node model.data_pipeline.stg_tpch_orders
[0m18:34:16.740615 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_pipeline.stg_tpch_orders"
[0m18:34:16.741615 [debug] [Thread-1 (]: Began executing node model.data_pipeline.stg_tpch_line_items
[0m18:34:16.763581 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_line_items"
[0m18:34:16.764581 [debug] [Thread-2 (]: Began executing node model.data_pipeline.stg_tpch_orders
[0m18:34:16.768454 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_pipeline.stg_tpch_orders"
[0m18:34:16.769452 [debug] [Thread-1 (]: Using snowflake connection "model.data_pipeline.stg_tpch_line_items"
[0m18:34:16.769452 [debug] [Thread-1 (]: On model.data_pipeline.stg_tpch_line_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_line_items"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_line_items
  
   as (
    select
    md5(cast(coalesce(cast(l_orderkey as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(l_linenumber as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_key,
	l_orderkey as order_key,
	l_partkey as part_key,
	l_linenumber as line_number,
	l_quantity as quantity,
	l_extendedprice as extended_price,
	l_discount as discount_percentage,
	l_tax as tax_rate
from
    snowflake_sample_data.tpch_sf1.lineitem
  );
[0m18:34:16.769452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:16.770964 [debug] [Thread-2 (]: Using snowflake connection "model.data_pipeline.stg_tpch_orders"
[0m18:34:16.771974 [debug] [Thread-2 (]: On model.data_pipeline.stg_tpch_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.stg_tpch_orders"} */
create or replace   view dbt_db.dbt_schema.stg_tpch_orders
  
   as (
    -- Lets try to pull in data from sources, use sources to pull in data from the source
-- This SQL code is selecting all columns from the orders table in the tpch schema. 
-- The snowflake_sample_data.tpch_sf1.orders part is a dbt macro that references the orders table 
-- in the tpch schema, ensuring that the correct table is used based on the source configuration in your dbt project.
--  do dbt run 
-- after running, you can check the data in the orders table in the tpch schema in the snowflake database

select 
    o_orderkey as order_key,
    o_custkey as customer_key,
    o_orderstatus as order_status,
    o_totalprice as total_price,
    o_orderdate as order_date
from 
    snowflake_sample_data.tpch_sf1.orders
  );
[0m18:34:16.771974 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:19.029412 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.257 seconds
[0m18:34:19.045410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.275 seconds
[0m18:34:19.048413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A566C04D40>]}
[0m18:34:19.048413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56BEA53D0>]}
[0m18:34:19.048413 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_schema.stg_tpch_orders .................... [[32mSUCCESS 1[0m in 2.32s]
[0m18:34:19.050408 [debug] [Thread-2 (]: Finished running node model.data_pipeline.stg_tpch_orders
[0m18:34:19.049411 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.stg_tpch_line_items ................ [[32mSUCCESS 1[0m in 2.33s]
[0m18:34:19.051413 [debug] [Thread-1 (]: Finished running node model.data_pipeline.stg_tpch_line_items
[0m18:34:19.052412 [debug] [Thread-4 (]: Began running node model.data_pipeline.int_order_items
[0m18:34:19.052412 [debug] [Thread-5 (]: Began running node model.data_pipeline.int_order_items_summary
[0m18:34:19.052412 [info ] [Thread-4 (]: 3 of 5 START sql table model dbt_schema.int_order_items ........................ [RUN]
[0m18:34:19.054414 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items'
[0m18:34:19.054414 [debug] [Thread-4 (]: Began compiling node model.data_pipeline.int_order_items
[0m18:34:19.053408 [info ] [Thread-5 (]: 4 of 5 START sql table model dbt_schema.int_order_items_summary ................ [RUN]
[0m18:34:19.059714 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_pipeline.int_order_items"
[0m18:34:19.060715 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.data_pipeline.int_order_items_summary'
[0m18:34:19.061712 [debug] [Thread-5 (]: Began compiling node model.data_pipeline.int_order_items_summary
[0m18:34:19.065711 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_pipeline.int_order_items_summary"
[0m18:34:19.065711 [debug] [Thread-4 (]: Began executing node model.data_pipeline.int_order_items
[0m18:34:19.081723 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_pipeline.int_order_items"
[0m18:34:19.082724 [debug] [Thread-5 (]: Began executing node model.data_pipeline.int_order_items_summary
[0m18:34:19.085719 [debug] [Thread-5 (]: Writing runtime sql for node "model.data_pipeline.int_order_items_summary"
[0m18:34:19.087325 [debug] [Thread-4 (]: Using snowflake connection "model.data_pipeline.int_order_items"
[0m18:34:19.088243 [debug] [Thread-5 (]: Using snowflake connection "model.data_pipeline.int_order_items_summary"
[0m18:34:19.088243 [debug] [Thread-4 (]: On model.data_pipeline.int_order_items: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items"} */
create or replace transient table dbt_db.dbt_schema.int_order_items
         as
        (select
    line_items.order_item_key,
    line_items.part_key,
    line_items.line_number,
    line_items.extended_price,
    orders.order_key,
    orders.customer_key,
    orders.order_date,
    
    (-1 * line_items.extended_price * line_items.discount_percentage)::decimal(16, 2)
 as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_orders as orders
join
    dbt_db.dbt_schema.stg_tpch_line_items as line_items
on
    orders.order_key = line_items.order_key
        );
[0m18:34:19.089241 [debug] [Thread-5 (]: On model.data_pipeline.int_order_items_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.int_order_items_summary"} */
create or replace transient table dbt_db.dbt_schema.int_order_items_summary
         as
        (select
    order_item_key,
    order_key,
    sum(extended_price) as gross_item_sales_amount,
    sum(discount_percentage * extended_price) as item_discount_amount
from
    dbt_db.dbt_schema.stg_tpch_line_items
group by
    order_item_key,
    order_key
        );
[0m18:34:19.090257 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:19.090257 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:34:26.518346 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 7.428 seconds
[0m18:34:26.520348 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56BFAFA40>]}
[0m18:34:26.520348 [info ] [Thread-5 (]: 4 of 5 OK created sql table model dbt_schema.int_order_items_summary ........... [[32mSUCCESS 1[0m in 7.46s]
[0m18:34:26.521349 [debug] [Thread-5 (]: Finished running node model.data_pipeline.int_order_items_summary
[0m18:34:26.522345 [debug] [Thread-7 (]: Began running node model.data_pipeline.fct_order
[0m18:34:26.522345 [info ] [Thread-7 (]: 5 of 5 START sql table model dbt_schema.fct_order .............................. [RUN]
[0m18:34:26.523352 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.data_pipeline.fct_order'
[0m18:34:26.523352 [debug] [Thread-7 (]: Began compiling node model.data_pipeline.fct_order
[0m18:34:26.526344 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_pipeline.fct_order"
[0m18:34:26.527344 [debug] [Thread-7 (]: Began executing node model.data_pipeline.fct_order
[0m18:34:26.529347 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_pipeline.fct_order"
[0m18:34:26.530342 [debug] [Thread-7 (]: Using snowflake connection "model.data_pipeline.fct_order"
[0m18:34:26.530342 [debug] [Thread-7 (]: On model.data_pipeline.fct_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "model.data_pipeline.fct_order"} */
create or replace transient table dbt_db.dbt_schema.fct_order
         as
        (-- select
--     orders.*,
--     order_item_summary.gross_item_sales_amount,
--     order_item_summary.item_discount_amount
-- from 
--     dbt_db.dbt_schema.stg_tpch_orders as orders 
-- join 
--     dbt_db.dbt_schema.int_order_items_summary as order_item_summary
-- on orders.order_key = order_item_summary.order_key
-- order by 
--     order_date

-- DESCRIBE TABLE dbt_schema.stg_tpch_orders;
-- name
-- ORDER_KEY
-- CUSTOMER_KEY
-- ORDER_STATUS
-- TOTAL_PRICE
-- ORDER_DATE

select
    orders.order_key,
    orders.customer_key,
    orders.order_status,  -- Corrected column name
    orders.total_price,
    orders.order_date,
    order_item_summary.gross_item_sales_amount,
    order_item_summary.item_discount_amount
from 
    dbt_db.dbt_schema.stg_tpch_orders as orders 
join 
    dbt_db.dbt_schema.int_order_items_summary as order_item_summary
on orders.order_key = order_item_summary.order_key
order by 
    order_date
        );
[0m18:34:26.530342 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:34:27.573367 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 8.483 seconds
[0m18:34:27.574365 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56BBB77D0>]}
[0m18:34:27.575365 [info ] [Thread-4 (]: 3 of 5 OK created sql table model dbt_schema.int_order_items ................... [[32mSUCCESS 1[0m in 8.52s]
[0m18:34:27.576368 [debug] [Thread-4 (]: Finished running node model.data_pipeline.int_order_items
[0m18:34:31.046176 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 4.515 seconds
[0m18:34:31.047175 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45008d59-cd85-4f24-a763-a56b1ba87d4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56BFF5880>]}
[0m18:34:31.048174 [info ] [Thread-7 (]: 5 of 5 OK created sql table model dbt_schema.fct_order ......................... [[32mSUCCESS 1[0m in 4.52s]
[0m18:34:31.049170 [debug] [Thread-7 (]: Finished running node model.data_pipeline.fct_order
[0m18:34:31.052179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:31.053173 [debug] [MainThread]: Connection 'list_dbt_db' was left open.
[0m18:34:31.053173 [debug] [MainThread]: On list_dbt_db: Close
[0m18:34:31.760361 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:34:31.761361 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:34:32.422685 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_line_items' was left open.
[0m18:34:32.422685 [debug] [MainThread]: On model.data_pipeline.stg_tpch_line_items: Close
[0m18:34:33.080405 [debug] [MainThread]: Connection 'model.data_pipeline.stg_tpch_orders' was left open.
[0m18:34:33.081409 [debug] [MainThread]: On model.data_pipeline.stg_tpch_orders: Close
[0m18:34:33.761467 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items' was left open.
[0m18:34:33.762474 [debug] [MainThread]: On model.data_pipeline.int_order_items: Close
[0m18:34:34.418810 [debug] [MainThread]: Connection 'model.data_pipeline.int_order_items_summary' was left open.
[0m18:34:34.419806 [debug] [MainThread]: On model.data_pipeline.int_order_items_summary: Close
[0m18:34:35.103362 [debug] [MainThread]: Connection 'model.data_pipeline.fct_order' was left open.
[0m18:34:35.104361 [debug] [MainThread]: On model.data_pipeline.fct_order: Close
[0m18:34:35.786987 [info ] [MainThread]: 
[0m18:34:35.787989 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 23.03 seconds (23.03s).
[0m18:34:35.789989 [debug] [MainThread]: Command end result
[0m18:34:35.815981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:34:35.817980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:34:35.823124 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:34:35.824117 [info ] [MainThread]: 
[0m18:34:35.825127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:35.825127 [info ] [MainThread]: 
[0m18:34:35.826181 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:34:35.827192 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:35.827192 after 24.71 seconds
[0m18:34:35.828194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A56883E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5676053D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A567605430>]}
[0m18:34:35.828194 [debug] [MainThread]: Flushing usage events
[0m18:34:37.390420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:46.356816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029867F216A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029867F21700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029867F21640>]}


============================== 18:34:46.362817 | ce977c17-952c-4275-ab13-368dc5e7dafb ==============================
[0m18:34:46.362817 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:34:46.363818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:46.728132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986A9CBD40>]}
[0m18:34:46.774128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986A3E62A0>]}
[0m18:34:46.776137 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:34:47.157940 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:34:47.337015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:47.337015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:47.374018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986AAA33B0>]}
[0m18:34:47.438544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:34:47.443542 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:34:47.484540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986C033350>]}
[0m18:34:47.485544 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 587 macros
[0m18:34:47.486541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986BC7B350>]}
[0m18:34:47.487545 [info ] [MainThread]: 
[0m18:34:47.488544 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:34:47.489541 [info ] [MainThread]: 
[0m18:34:47.490544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:47.493543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:34:47.617647 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:34:47.617647 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:34:47.617647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:49.580554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.962 seconds
[0m18:34:49.583558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce977c17-952c-4275-ab13-368dc5e7dafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986C216000>]}
[0m18:34:49.587553 [debug] [Thread-1 (]: Began running node test.data_pipeline.fct_orders_discount
[0m18:34:49.588550 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:34:49.588550 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:34:49.589555 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:34:49.588550 [info ] [Thread-1 (]: 1 of 4 START test fct_orders_discount .......................................... [RUN]
[0m18:34:49.589555 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m18:34:49.591551 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m18:34:49.590557 [info ] [Thread-3 (]: 3 of 4 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m18:34:49.592554 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m18:34:49.590557 [info ] [Thread-4 (]: 4 of 4 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m18:34:49.592554 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m18:34:49.593553 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m18:34:49.593553 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:34:49.593553 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m18:34:49.602549 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m18:34:49.603551 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:34:49.615562 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:34:49.615562 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:34:49.623106 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:34:49.628626 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:34:49.628626 [debug] [Thread-1 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m18:34:49.644688 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m18:34:49.646684 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:34:49.646684 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:34:49.647685 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:34:49.649686 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:34:49.650686 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m18:34:49.652685 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:34:49.656210 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:34:49.657218 [debug] [Thread-1 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount > 0
      
    ) dbt_internal_test
[0m18:34:49.658212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:49.660211 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:34:49.660211 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:34:49.661211 [debug] [Thread-4 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:49.661211 [debug] [Thread-2 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m18:34:49.662211 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:34:49.662211 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:49.663212 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:49.663212 [debug] [Thread-3 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:34:49.664211 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:34:51.799623 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.136 seconds
[0m18:34:51.806617 [info ] [Thread-3 (]: 3 of 4 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.21s]
[0m18:34:51.807617 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:34:51.883548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.220 seconds
[0m18:34:51.886063 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.29s]
[0m18:34:51.886063 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:34:51.888570 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.226 seconds
[0m18:34:51.890569 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.30s]
[0m18:34:51.891569 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:34:51.938317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.281 seconds
[0m18:34:51.940317 [error] [Thread-1 (]: 1 of 4 FAIL 5456329 fct_orders_discount ........................................ [[31mFAIL 5456329[0m in 2.35s]
[0m18:34:51.941316 [debug] [Thread-1 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m18:34:51.942317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:51.943325 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:34:51.943325 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:34:52.646215 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m18:34:52.646215 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m18:34:53.409859 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m18:34:53.409859 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m18:34:54.066719 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m18:34:54.067721 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m18:34:54.770094 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m18:34:54.771092 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m18:34:55.440959 [info ] [MainThread]: 
[0m18:34:55.441959 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m18:34:55.443963 [debug] [MainThread]: Command end result
[0m18:34:55.461961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:34:55.464964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:34:55.470996 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:34:55.472043 [info ] [MainThread]: 
[0m18:34:55.472043 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:34:55.473041 [info ] [MainThread]: 
[0m18:34:55.473041 [error] [MainThread]: [31mFailure in test fct_orders_discount (tests\fct_orders_discount.sql)[0m
[0m18:34:55.474041 [error] [MainThread]:   Got 5456329 results, configured to fail if != 0
[0m18:34:55.474041 [info ] [MainThread]: 
[0m18:34:55.475040 [info ] [MainThread]:   compiled code at target\compiled\data_pipeline\tests\fct_orders_discount.sql
[0m18:34:55.475040 [info ] [MainThread]: 
[0m18:34:55.476042 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:34:55.477040 [debug] [MainThread]: Command `dbt test` failed at 18:34:55.477040 after 9.33 seconds
[0m18:34:55.477040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986A046B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986C05A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986AA573B0>]}
[0m18:34:55.477040 [debug] [MainThread]: Flushing usage events
[0m18:34:56.542819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:02.538358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A4FD0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A7F606B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A5CB32C0>]}


============================== 18:38:02.544355 | e8010e2c-5e0a-4331-ac14-bc87d75c0801 ==============================
[0m18:38:02.544355 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:38:02.545355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\6133179\\.dbt', 'log_path': 'C:\\Training\\DBTpractice\\data_pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:02.926660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A8DDDBE0>]}
[0m18:38:02.976219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A88D0560>]}
[0m18:38:02.977220 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:38:03.476382 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:38:03.635882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:03.636883 [debug] [MainThread]: Partial parsing: updated file: data_pipeline://tests\fct_orders_discount.sql
[0m18:38:03.759416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AA6ED010>]}
[0m18:38:03.823090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:38:03.827086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:38:03.867222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AA8C04A0>]}
[0m18:38:03.868118 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 587 macros
[0m18:38:03.868118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AA239B20>]}
[0m18:38:03.870628 [info ] [MainThread]: 
[0m18:38:03.870628 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:38:03.871637 [info ] [MainThread]: 
[0m18:38:03.871637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:03.875636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_db_dbt_schema'
[0m18:38:03.993012 [debug] [ThreadPool]: Using snowflake connection "list_dbt_db_dbt_schema"
[0m18:38:03.993012 [debug] [ThreadPool]: On list_dbt_db_dbt_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "connection_name": "list_dbt_db_dbt_schema"} */
show objects in dbt_db.dbt_schema limit 10000;
[0m18:38:03.993012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:06.081269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.088 seconds
[0m18:38:06.084266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8010e2c-5e0a-4331-ac14-bc87d75c0801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AA6A6AB0>]}
[0m18:38:06.089265 [debug] [Thread-1 (]: Began running node test.data_pipeline.fct_orders_discount
[0m18:38:06.089265 [debug] [Thread-2 (]: Began running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:38:06.090265 [debug] [Thread-3 (]: Began running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:38:06.089265 [info ] [Thread-1 (]: 1 of 4 START test fct_orders_discount .......................................... [RUN]
[0m18:38:06.090265 [debug] [Thread-4 (]: Began running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:38:06.091265 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_tpch_orders_o_orderkey ....................... [RUN]
[0m18:38:06.091265 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.data_pipeline.fct_orders_discount'
[0m18:38:06.091265 [info ] [Thread-3 (]: 3 of 4 START test source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [RUN]
[0m18:38:06.093267 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b'
[0m18:38:06.092265 [info ] [Thread-4 (]: 4 of 4 START test source_unique_tpch_orders_o_orderkey ......................... [RUN]
[0m18:38:06.093267 [debug] [Thread-1 (]: Began compiling node test.data_pipeline.fct_orders_discount
[0m18:38:06.094266 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d'
[0m18:38:06.094266 [debug] [Thread-2 (]: Began compiling node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:38:06.095266 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2'
[0m18:38:06.101271 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_pipeline.fct_orders_discount"
[0m18:38:06.102271 [debug] [Thread-3 (]: Began compiling node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:38:06.110783 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:38:06.110783 [debug] [Thread-4 (]: Began compiling node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:38:06.119793 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:38:06.125792 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:38:06.126792 [debug] [Thread-1 (]: Began executing node test.data_pipeline.fct_orders_discount
[0m18:38:06.146312 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_pipeline.fct_orders_discount"
[0m18:38:06.147313 [debug] [Thread-2 (]: Began executing node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:38:06.147313 [debug] [Thread-3 (]: Began executing node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:38:06.148310 [debug] [Thread-4 (]: Began executing node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:38:06.151212 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:38:06.154210 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:38:06.156241 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:38:06.157241 [debug] [Thread-1 (]: Using snowflake connection "test.data_pipeline.fct_orders_discount"
[0m18:38:06.158238 [debug] [Thread-1 (]: On test.data_pipeline.fct_orders_discount: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.fct_orders_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select
    *
from
    dbt_db.dbt_schema.fct_order
where
    item_discount_amount < 0
      
    ) dbt_internal_test
[0m18:38:06.158238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:06.160238 [debug] [Thread-2 (]: Using snowflake connection "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"
[0m18:38:06.161240 [debug] [Thread-3 (]: Using snowflake connection "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"
[0m18:38:06.161240 [debug] [Thread-4 (]: Using snowflake connection "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"
[0m18:38:06.162241 [debug] [Thread-2 (]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select o_orderkey
from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is null



      
    ) dbt_internal_test
[0m18:38:06.163237 [debug] [Thread-3 (]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select l_orderkey as from_field
    from snowflake_sample_data.tpch_sf1.lineitem
    where l_orderkey is not null
),

parent as (
    select o_orderkey as to_field
    from snowflake_sample_data.tpch_sf1.orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:38:06.163237 [debug] [Thread-4 (]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "data_pipeline", "target_name": "dev", "node_id": "test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    o_orderkey as unique_field,
    count(*) as n_records

from snowflake_sample_data.tpch_sf1.orders
where o_orderkey is not null
group by o_orderkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:06.164237 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:38:06.164237 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:38:06.165241 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:38:08.296272 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.133 seconds
[0m18:38:08.303274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.145 seconds
[0m18:38:08.302274 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_tpch_orders_o_orderkey ............................. [[32mPASS[0m in 2.21s]
[0m18:38:08.305274 [debug] [Thread-2 (]: Finished running node test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b
[0m18:38:08.305274 [info ] [Thread-1 (]: 1 of 4 PASS fct_orders_discount ................................................ [[32mPASS[0m in 2.21s]
[0m18:38:08.306275 [debug] [Thread-1 (]: Finished running node test.data_pipeline.fct_orders_discount
[0m18:38:08.462852 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.298 seconds
[0m18:38:08.464851 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_tpch_orders_o_orderkey ............................... [[32mPASS[0m in 2.37s]
[0m18:38:08.465851 [debug] [Thread-4 (]: Finished running node test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2
[0m18:38:08.466850 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.303 seconds
[0m18:38:08.467849 [info ] [Thread-3 (]: 3 of 4 PASS source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_  [[32mPASS[0m in 2.37s]
[0m18:38:08.468849 [debug] [Thread-3 (]: Finished running node test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d
[0m18:38:08.470851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:08.471859 [debug] [MainThread]: Connection 'list_dbt_db_dbt_schema' was left open.
[0m18:38:08.471859 [debug] [MainThread]: On list_dbt_db_dbt_schema: Close
[0m18:38:09.139793 [debug] [MainThread]: Connection 'test.data_pipeline.fct_orders_discount' was left open.
[0m18:38:09.139793 [debug] [MainThread]: On test.data_pipeline.fct_orders_discount: Close
[0m18:38:09.815242 [debug] [MainThread]: Connection 'test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b' was left open.
[0m18:38:09.816245 [debug] [MainThread]: On test.data_pipeline.source_not_null_tpch_orders_o_orderkey.ebd571817b: Close
[0m18:38:10.499730 [debug] [MainThread]: Connection 'test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d' was left open.
[0m18:38:10.499730 [debug] [MainThread]: On test.data_pipeline.source_relationships_tpch_lineitem_l_orderkey__o_orderkey__source_tpch_orders_.f722cb898d: Close
[0m18:38:11.166421 [debug] [MainThread]: Connection 'test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2' was left open.
[0m18:38:11.166421 [debug] [MainThread]: On test.data_pipeline.source_unique_tpch_orders_o_orderkey.374f048af2: Close
[0m18:38:11.842980 [info ] [MainThread]: 
[0m18:38:11.843971 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m18:38:11.845981 [debug] [MainThread]: Command end result
[0m18:38:11.865691 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Training\DBTpractice\data_pipeline\target\manifest.json
[0m18:38:11.867694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Training\DBTpractice\data_pipeline\target\semantic_manifest.json
[0m18:38:11.872966 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Training\DBTpractice\data_pipeline\target\run_results.json
[0m18:38:11.873963 [info ] [MainThread]: 
[0m18:38:11.873963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:11.874963 [info ] [MainThread]: 
[0m18:38:11.874963 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:38:11.875970 [debug] [MainThread]: Command `dbt test` succeeded at 18:38:11.875970 after 9.54 seconds
[0m18:38:11.875970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A854E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228A89511F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228AA219550>]}
[0m18:38:11.875970 [debug] [MainThread]: Flushing usage events
[0m18:38:13.144339 [debug] [MainThread]: An error was encountered while trying to flush usage events
